

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Getting started &mdash; yggdrasil v1.6.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Formatted I/O" href="formatted_io.html" />
    <link rel="prev" title="Installation" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> yggdrasil
          

          
          </a>

          
            
            
              <div class="version">
                v1.6.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="includeme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-a-model">Running a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-multiple-models">Running multiple models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-remote-models">Running remote models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-file-input-output">Model file input/output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-to-model-communication-with-connections">Model-to-model communication (with connections)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-to-model-communication-with-drivers">Model-to-model communication (with drivers)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="formatted_io.html">Formatted I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="server_client_io.html">Server/Client I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="autowrap.html">Autowrapping Model Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="autowrap.html#notes-on-autowrapping-c-c-model-functions">Notes on Autowrapping C/C++ Model Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditional_io.html">Conditional I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformed_io.html">Transformed I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="timesync_io.html">Timestep Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="yaml.html">YAML Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_format_strings.html">C-Style Format Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading.html">OpenMP Threading in Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/examples_toc.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced/index.html">Advanced</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="hackathon2018/index.html">Welcome to the 2018 Crops in Silico Hackathon!</a></li>
<li class="toctree-l1"><a class="reference internal" href="hackathon2019/index.html">Welcome to the 2019 Crops in Silico Hackathon!</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">yggdrasil</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Getting started</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/getting_started.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started">
<span id="getting-started-rst"></span><h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>The yggdrasil framework runs user defined models and orchestrates asynchronous
communication between models using drivers that coordinate the different
components via threads. Model drivers run the models as seperate processes
and monitor them to redirect output to stdout and determine if the model
is still running, needs to be terminated, or has encountered an error.
Input/output drivers connect communication channels (comms) between models
and/or files. On the model side, interface API functions/classes are provided
in different programming languages to allow models to access these comms.</p>
<div class="section" id="running-a-model">
<h2>Running a model<a class="headerlink" href="#running-a-model" title="Permalink to this headline">¶</a></h2>
<p>Models are run by creating a YAML file that specifies the location of the model
code and the type of model. Consider the following model which just prints a
single line of output to stdout:</p>
<p>Model Code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello from Python&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="examples/gs_lesson1.html">Example in other languages</a>)</p>
<p>The YAML file to run this model would then be:</p>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nt">models</span><span class="p">:</span>
<span class="linenos">2</span>  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python_model</span>
<span class="linenos">3</span>    <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>  <span class="c1"># Runs the python script using default Python</span>
<span class="linenos">4</span>    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src/gs_lesson1.py</span>
</pre></div>
</div>
<p>(<a class="reference external" href="examples/gs_lesson1.html">Example in other languages</a>)</p>
<p>The first line signals that there is a model, the second line is the name that
should be associated with the model for logging, the third line tells the
framework which language the model is written in (and therefore which driver
should be used to execute the model), and the forth line is
the path to the model source code that should be run. There are specialized
drivers for simple source written in Python, Matlab, C, and C++, but any
executable can be run as a model using <code class="docutils literal notranslate"><span class="pre">language:</span> <span class="pre">executable</span></code> and passing the
path to the executable to the <code class="docutils literal notranslate"><span class="pre">args</span></code> parameter. Additional information on
the format yggdrasil YAML files should take can be found in the
<a class="reference internal" href="yaml.html#yaml-rst"><span class="std std-ref">YAML Files</span></a> section.</p>
<p>This model can then be run using the yggdrasil framework by calling the
commandline entry point <cite>yggrun</cite> followed by the path to the YAML.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ yggrun model.yml
</pre></div>
</div>
</div>
<div class="section" id="running-multiple-models">
<h2>Running multiple models<a class="headerlink" href="#running-multiple-models" title="Permalink to this headline">¶</a></h2>
<p>Multiple models can be run by either passing multiple YAML files to <cite>yggrun</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ yggrun model1.yml model2.yml
</pre></div>
</div>
<p>or including multiple models in a single YAML file.</p>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nt">models</span><span class="p">:</span>
<span class="linenos">2</span>  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python_model1</span>
<span class="linenos">3</span>    <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>  <span class="c1"># Runs the python script using default Python</span>
<span class="linenos">4</span>    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src/gs_lesson2.py</span>
<span class="linenos">5</span>
<span class="linenos">6</span>  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python_model2</span>
<span class="linenos">7</span>    <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="linenos">8</span>    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src/gs_lesson2.py</span>
</pre></div>
</div>
<p>(<a class="reference external" href="examples/gs_lesson2.html">Example in other languages</a>)</p>
</div>
<div class="section" id="running-remote-models">
<h2>Running remote models<a class="headerlink" href="#running-remote-models" title="Permalink to this headline">¶</a></h2>
<p>Models stored on remote Git repositories can be run by prepending ‘git:’ to the YAML file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ yggrun git:http://github.com/foo/bar/yam/remote_model.yml
</pre></div>
</div>
<p><cite>yggrun</cite> will clone the repo (foo/bar in this example) and then process remote_model.yml as normal. The
host site need not be specified if it is github.com:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ yggrun git:foo/bar/yam/remote_model.yml
</pre></div>
</div>
<p>will behave identically to the first example. Remote and local models can be mixed on
the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ yggrun model1.yml git:foo/bar/yam/remote_model.yml model2.yml
</pre></div>
</div>
</div>
<div class="section" id="model-file-input-output">
<h2>Model file input/output<a class="headerlink" href="#model-file-input-output" title="Permalink to this headline">¶</a></h2>
<p>Models can get input from or send output to files via input and output channels.
To do so yggdrasil provides several useful functions for interfacing with
these channels. In the example below, the model receives input from a channel
named <code class="docutils literal notranslate"><span class="pre">input</span></code> and sends output to a channel named <code class="docutils literal notranslate"><span class="pre">output</span></code>.</p>
<p>Model Code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Import classes for input/output channels</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">yggdrasil.interface.YggInterface</span> <span class="kn">import</span> <span class="n">YggInput</span><span class="p">,</span> <span class="n">YggOutput</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Initialize input/output channels</span>
<span class="linenos"> 5</span><span class="n">in_channel</span> <span class="o">=</span> <span class="n">YggInput</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="n">out_channel</span> <span class="o">=</span> <span class="n">YggOutput</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Loop until there is no longer input or the queues are closed</span>
<span class="linenos"> 9</span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="linenos">10</span>    
<span class="linenos">11</span>    <span class="c1"># Receive input from input channel</span>
<span class="linenos">12</span>    <span class="c1"># If there is an error, the flag will be False</span>
<span class="linenos">13</span>    <span class="n">flag</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">in_channel</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="linenos">14</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
<span class="linenos">15</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No more input.&quot;</span><span class="p">)</span>
<span class="linenos">16</span>        <span class="k">break</span>
<span class="linenos">17</span>
<span class="linenos">18</span>    <span class="c1"># Print received message</span>
<span class="linenos">19</span>    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="c1"># Send output to output channel</span>
<span class="linenos">22</span>    <span class="c1"># If there is an error, the flag will be False</span>
<span class="linenos">23</span>    <span class="n">flag</span> <span class="o">=</span> <span class="n">out_channel</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="linenos">24</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
<span class="linenos">25</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error sending output.&quot;</span><span class="p">)</span>
<span class="linenos">26</span>        <span class="k">break</span>
</pre></div>
</div>
<p>(<a class="reference external" href="examples/gs_lesson3.html">Example in other languages</a>)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Real models YAMLs should use more description names for the input and output
channels to make it easier for collaborators to determine the information
begin passed through the channel.</p>
</div>
<p>In the YAML used to run this model, those channels are declared in the model
definition and then linked to files by entries in the <code class="docutils literal notranslate"><span class="pre">connections</span></code> section
of the YAML.</p>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">models</span><span class="p">:</span>
<span class="linenos"> 2</span>  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python_model</span>
<span class="linenos"> 3</span>    <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>  <span class="c1"># Runs the python script using default Python</span>
<span class="linenos"> 4</span>    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src/gs_lesson3.py</span>
<span class="linenos"> 5</span>    <span class="nt">inputs</span><span class="p">:</span>
<span class="linenos"> 6</span>      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">input</span>
<span class="linenos"> 7</span>    <span class="nt">outputs</span><span class="p">:</span>
<span class="linenos"> 8</span>      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">output</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="nt">connections</span><span class="p">:</span>
<span class="linenos">11</span>  <span class="p p-Indicator">-</span> <span class="nt">input_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input.txt</span>
<span class="linenos">12</span>    <span class="nt">output</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">input</span>
<span class="linenos">13</span>  <span class="p p-Indicator">-</span> <span class="nt">input</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output</span>
<span class="linenos">14</span>    <span class="nt">output</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./output.txt</span>
</pre></div>
</div>
<p>(<a class="reference external" href="examples/gs_lesson3.html">Example in other languages</a>)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">input_file</span></code> and <code class="docutils literal notranslate"><span class="pre">output_file</span></code> connection fields can either be
the path to the file (either absolute or relative to the directory
containing the YAML file) or a mapping with fields descripting the
file. In particular, the <code class="docutils literal notranslate"><span class="pre">filetype</span></code> keyword specifies the format of
the file being read/written. Supported values include:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>The entire file is read/written all at once as bytes.</p></td>
</tr>
<tr class="row-odd"><td><p>ascii</p></td>
<td><p>The file is read/written one line at a time.</p></td>
</tr>
<tr class="row-even"><td><p>table</p></td>
<td><p>The file is an ASCII table that will be read/written one row
at a time. If <code class="docutils literal notranslate"><span class="pre">as_array:</span> <span class="pre">True</span></code> is also specified, the table
will be read/written all at once.</p></td>
</tr>
<tr class="row-odd"><td><p>pandas</p></td>
<td><p>The file is a Pandas frame output as a table.</p></td>
</tr>
<tr class="row-even"><td><p>pickle</p></td>
<td><p>The file contains one or more pickled Python objects.</p></td>
</tr>
<tr class="row-odd"><td><p>ply</p></td>
<td><p>The file is in <a class="reference external" href="http://paulbourke.net/dataformats/ply/">Ply</a>
data format for 3D structures.</p></td>
</tr>
<tr class="row-even"><td><p>obj</p></td>
<td><p>The file is in <a class="reference external" href="http://paulbourke.net/dataformats/obj/">Obj</a>
data format for 3D structures.</p></td>
</tr>
</tbody>
</table>
<p>The above example shows the basic case of receiving raw messages from a channel,
but there are also interface functions which can process these raw messages to
extract variables and fields for the model <code class="docutils literal notranslate"><span class="pre">inputs</span></code> and <code class="docutils literal notranslate"><span class="pre">outputs</span></code> to
specify how that should be done. For examples of how to use formatted messages
with the above file types and input/output options, see
<a class="reference internal" href="formatted_io.html#formatted-io-rst"><span class="std std-ref">Formatted I/O</span></a>.</p>
</div>
<div class="section" id="model-to-model-communication-with-connections">
<h2>Model-to-model communication (with connections)<a class="headerlink" href="#model-to-model-communication-with-connections" title="Permalink to this headline">¶</a></h2>
<p>Models can also communicate with each other in the same fashion. In the example
below, model A receives input from a channel named ‘inputA’ and sends output to
a channel named ‘outputA’, while model B receives input from a channel named
‘inputB’ and sends output to a channel named ‘outputB’.</p>
<p>Model Code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Import classes for input/output channels</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">yggdrasil.interface.YggInterface</span> <span class="kn">import</span> <span class="n">YggInput</span><span class="p">,</span> <span class="n">YggOutput</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Initialize input/output channels</span>
<span class="linenos"> 5</span><span class="n">in_channel</span> <span class="o">=</span> <span class="n">YggInput</span><span class="p">(</span><span class="s1">&#39;inputA&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="n">out_channel</span> <span class="o">=</span> <span class="n">YggOutput</span><span class="p">(</span><span class="s1">&#39;outputA&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Loop until there is no longer input or the queues are closed</span>
<span class="linenos"> 9</span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="c1"># Receive input from input channel</span>
<span class="linenos">12</span>    <span class="c1"># If there is an error, the flag will be False</span>
<span class="linenos">13</span>    <span class="n">flag</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">in_channel</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="linenos">14</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
<span class="linenos">15</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model A: No more input.&quot;</span><span class="p">)</span>
<span class="linenos">16</span>        <span class="k">break</span>
<span class="linenos">17</span>
<span class="linenos">18</span>    <span class="c1"># Print received message</span>
<span class="linenos">19</span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model A: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">msg</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="c1"># Send output to output channel</span>
<span class="linenos">22</span>    <span class="c1"># If there is an error, the flag will be False</span>
<span class="linenos">23</span>    <span class="n">flag</span> <span class="o">=</span> <span class="n">out_channel</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="linenos">24</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
<span class="linenos">25</span>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Model A: Error sending output.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Import classes for input/output channels</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">yggdrasil.interface.YggInterface</span> <span class="kn">import</span> <span class="n">YggInput</span><span class="p">,</span> <span class="n">YggOutput</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Initialize input/output channels</span>
<span class="linenos"> 5</span><span class="n">in_channel</span> <span class="o">=</span> <span class="n">YggInput</span><span class="p">(</span><span class="s1">&#39;inputB&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="n">out_channel</span> <span class="o">=</span> <span class="n">YggOutput</span><span class="p">(</span><span class="s1">&#39;outputB&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Loop until there is no longer input or the queues are closed</span>
<span class="linenos"> 9</span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="c1"># Receive input from input channel</span>
<span class="linenos">12</span>    <span class="c1"># If there is an error, the flag will be False</span>
<span class="linenos">13</span>    <span class="n">flag</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">in_channel</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="linenos">14</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
<span class="linenos">15</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model B: No more input.&quot;</span><span class="p">)</span>
<span class="linenos">16</span>        <span class="k">break</span>
<span class="linenos">17</span>
<span class="linenos">18</span>    <span class="c1"># Print received message</span>
<span class="linenos">19</span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model B: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">msg</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="c1"># Send output to output channel</span>
<span class="linenos">22</span>    <span class="c1"># If there is an error, the flag will be False</span>
<span class="linenos">23</span>    <span class="n">flag</span> <span class="o">=</span> <span class="n">out_channel</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="linenos">24</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
<span class="linenos">25</span>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Model B: Error sending output.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="examples/gs_lesson4.html">Example in other languages</a>)</p>
<p>In the YAML, ‘inputA’ is connected to a local file, ‘outputA’ is connected to
‘inputB’, and ‘outputB’ is connected to a local file in the <code class="docutils literal notranslate"><span class="pre">connections</span></code>
section of the YAML.</p>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">models</span><span class="p">:</span>
<span class="linenos"> 2</span>  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python_modelA</span>
<span class="linenos"> 3</span>    <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="linenos"> 4</span>    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src/gs_lesson4_modelA.py</span>
<span class="linenos"> 5</span>    <span class="nt">inputs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputA</span>
<span class="linenos"> 6</span>    <span class="nt">outputs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputA</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python_modelB</span>
<span class="linenos"> 9</span>    <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="linenos">10</span>    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src/gs_lesson4_modelB.py</span>
<span class="linenos">11</span>    <span class="nt">inputs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputB</span>
<span class="linenos">12</span>    <span class="nt">outputs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputB</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="nt">connections</span><span class="p">:</span>
<span class="linenos">15</span>  <span class="p p-Indicator">-</span> <span class="nt">input</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputA</span>  <span class="c1"># Connection between model A output &amp; model B input</span>
<span class="linenos">16</span>    <span class="nt">output</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputB</span>
<span class="linenos">17</span>  <span class="p p-Indicator">-</span> <span class="nt">input</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input.txt</span>  <span class="c1"># Connection between file and model A input</span>
<span class="linenos">18</span>    <span class="nt">output</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputA</span>
<span class="linenos">19</span>  <span class="p p-Indicator">-</span> <span class="nt">input</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputB</span>  <span class="c1"># Connection between model B output and file</span>
<span class="linenos">20</span>    <span class="nt">output</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./output.txt</span>
</pre></div>
</div>
<p>(<a class="reference external" href="examples/gs_lesson4.html">Example in other languages</a>)</p>
</div>
<div class="section" id="model-to-model-communication-with-drivers">
<h2>Model-to-model communication (with drivers)<a class="headerlink" href="#model-to-model-communication-with-drivers" title="Permalink to this headline">¶</a></h2>
<p>For backwards compatibility, connections can also be specified in terms of
the underlying drivers without an explicit <code class="docutils literal notranslate"><span class="pre">connections</span></code> section. The
exact same models from the previous example can be connected using the
following YAML.</p>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">models</span><span class="p">:</span>
<span class="linenos"> 2</span>  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python_modelA</span>
<span class="linenos"> 3</span>    <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="linenos"> 4</span>    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src/gs_lesson4b_modelA.py</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>    <span class="nt">inputs</span><span class="p">:</span>
<span class="linenos"> 7</span>      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputA</span>
<span class="linenos"> 8</span>        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FileInputDriver</span>
<span class="linenos"> 9</span>        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input.txt</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="nt">outputs</span><span class="p">:</span>
<span class="linenos">12</span>      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputA</span>
<span class="linenos">13</span>        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>  <span class="c1"># Output to another channel</span>
<span class="linenos">14</span>        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A_to_B</span>  <span class="c1"># Connection to inputB</span>
<span class="linenos">15</span>
<span class="linenos">16</span>  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python_modelB</span>
<span class="linenos">17</span>    <span class="nt">language</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="linenos">18</span>    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./src/gs_lesson4b_modelB.py</span>
<span class="linenos">19</span>
<span class="linenos">20</span>    <span class="nt">inputs</span><span class="p">:</span>
<span class="linenos">21</span>      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputB</span>
<span class="linenos">22</span>        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>  <span class="c1"># Input from another channel</span>
<span class="linenos">23</span>        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A_to_B</span>  <span class="c1"># Conneciton to inputA</span>
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="nt">outputs</span><span class="p">:</span>
<span class="linenos">26</span>      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputB</span>
<span class="linenos">27</span>        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FileOutputDriver</span>
<span class="linenos">28</span>        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./output.txt</span>
</pre></div>
</div>
<p>(<a class="reference external" href="examples/gs_lesson4b.html">Example in other languages</a>)</p>
<p>In this schema, model <code class="docutils literal notranslate"><span class="pre">input</span></code> and <code class="docutils literal notranslate"><span class="pre">output</span></code> entries
must have the following fields:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 92%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>The name of the channel that will be used by the model.</p></td>
</tr>
<tr class="row-odd"><td><p>driver</p></td>
<td><p>The name of the driver that should be used to process input/output.</p></td>
</tr>
<tr class="row-even"><td><p>args</p></td>
<td><p>A string matching the args field of an opposing <code class="docutils literal notranslate"><span class="pre">input</span></code> /
<code class="docutils literal notranslate"><span class="pre">output</span></code> field in another model or the path to a file that should
be read/written.</p></td>
</tr>
</tbody>
</table>
<p>A list of possible Input/Output drivers can be found <a class="reference internal" href="advanced/io_drivers.html#io-drivers-rst"><span class="std std-ref">here</span></a>.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Link to example with translation at connection.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="formatted_io.html" class="btn btn-neutral float-right" title="Formatted I/O" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="install.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017, Meagan Lang, David Raila.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>