

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>General Development Notes &mdash; yggdrasil v1.6.4 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Release Steps" href="release.html" />
    <link rel="prev" title="Development" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> yggdrasil
          

          
          </a>

          
            
            
              <div class="version">
                v1.6.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../includeme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formatted_io.html">Formatted I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_client_io.html">Server/Client I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autowrap.html">Autowrapping Model Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conditional_io.html">Conditional I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformed_io.html">Transformed I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timesync_io.html">Timestep Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yaml.html">YAML Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../c_format_strings.html">C-Style Format Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../threading.html">OpenMP Threading in Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples_toc.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Advanced</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Development</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">General Development Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#development-workflow">Development Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-a-dev-environment">Setting Up a Dev Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="release.html">Release Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_language.html">Adding Support for a New Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_datatype.html">Defining New Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="todo.html">TODO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon2018/index.html">Welcome to the 2018 Crops in Silico Hackathon!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon2019/index.html">Welcome to the 2019 Crops in Silico Hackathon!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon2021/index.html">Welcome to the 2021 Crops in Silico Hackathon!</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">yggdrasil</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Development</a> &raquo;</li>
        
      <li>General Development Notes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/development/general.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="general-development-notes">
<span id="general-rst"></span><h1>General Development Notes<a class="headerlink" href="#general-development-notes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="development-workflow">
<h2>Development Workflow<a class="headerlink" href="#development-workflow" title="Permalink to this headline">¶</a></h2>
<p>Development of yggdrasil should be done on branches and/or forks that
are then merged in via pull request after passing linting (via
<a class="reference external" href="http://flake8.pycqa.org/en/latest/">flake8</a>), testing (via
continuous integration on
<a class="reference external" href="https://travis-ci.org/cropsinsilico/yggdrasil">travis</a> and
<a class="reference external" href="https://ci.appveyor.com/project/langmm/yggdrasil">appveyor</a>),
and code review. Prior to beginning new development,
developers should open a Github issue on the repository that describes
the proposed changes and/or features so that discussion can help identify
potential sticking points, features that already exist but are poorly documented,
and features that would break a significant portion of the code.</p>
</div>
<div class="section" id="setting-up-a-dev-environment">
<span id="dev-env-rst"></span><h2>Setting Up a Dev Environment<a class="headerlink" href="#setting-up-a-dev-environment" title="Permalink to this headline">¶</a></h2>
<p>The following is only one method for setting up a development environment. You are welcome to select another method (e.g. using virtual env), but this is what has worked for me.</p>
<ol class="arabic">
<li><p>[WINDOWS ONLY] Download and install Visual Studio Community from <a class="reference external" href="https://visualstudio.microsoft.com/vs/community/">here</a>. During installation, we recommend selecting the components below. If you forget to add something during the initial download, you can always modify the installation via the “Visual Studio Installer” program.</p>
<ul class="simple">
<li><p>“Desktop development with C++” - Workload under “Windows” section</p></li>
<li><p>“MSVC v140 - VS 2015 C++ build tools (v14.00)” - Individual component under “Compilers, build tools, and runtimes” section.</p></li>
</ul>
<p>If you will be developing on Python 2, you will need additional compilers that can be found <a class="reference external" href="https://www.microsoft.com/en-us/download/details.aspx?id=44266">here</a>.</p>
</li>
<li><p>[OPTIONAL] Download and install Miniconda (or Anaconda) from <a class="reference external" href="https://www.anaconda.com/download/">here</a>. Once downloaded, run the following command from the terminal (or Anaconda Prompt on Windows) to add the <code class="docutils literal notranslate"><span class="pre">conda-forge</span></code> channel to the list of conda channels that will be searched when conda installs packages.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda config --add channels conda-forge
</pre></div>
</div>
</li>
<li><p>Create a fork of the yggdrasil Github repository for you Github account (<code class="docutils literal notranslate"><span class="pre">Fork</span></code> button located in the upper right corner of the yggdrasil <a class="reference external" href="https://github.com/cropsinsilico/yggdrasil">Github repository</a>).</p></li>
<li><p>Clone your fork of the yggdrasil repository using git and then change directory into the cloned repository. NOTE: If you do not have <code class="docutils literal notranslate"><span class="pre">git</span></code> you can either <a class="reference external" href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">install it yourself</a> or using conda (<code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">git</span></code>).:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone --recurse-submodules https://github.com/&lt;your Github username&gt;/yggdrasil.git
$ cd yggdrasil
</pre></div>
</div>
</li>
<li><p>[OPTIONAL] Create a conda environment for development and activate that environment. You can create an environment using any of the supported versions of Python and may need more than one for testing.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda create -n ygg python=3.6
$ conda activate ygg
</pre></div>
</div>
<p>yggdrasil provides a python script, <code class="docutils literal notranslate"><span class="pre">utils/create_envs.py</span></code> for creating development environments and installing yggdrasil in develoment mode for a combination of dependency installation methods (pip vs. conda) and versions of Python. For example, to create a conda environment with Python 3.6 (as above) and install yggdrasil’s dependencies using conda, the following commands can
be executed from the root directory of your local yggdrasil repository.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python utils/create_envs.py --name=ygg
$ conda activate ygg
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>If you use ``utils/create_envs.py`` to create your dev environment, you can skip to the last step.</strong></p>
</div>
</li>
<li><p>Install the requirements using conda via the helper script <code class="docutils literal notranslate"><span class="pre">utils/install_from_requirements.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python utils/install_from_requirements.py conda requirements.txt requirements_condaonly.txt requirements_testing.txt
</pre></div>
</div>
<p>Alternatively, if you did not install conda, you can install the Python dependencies using <code class="docutils literal notranslate"><span class="pre">pip</span></code> via the same script.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python utils/install_from_requirements.py pip requirements.txt requirements_testing.txt
</pre></div>
</div>
<p>However, if you use this method, you will need to manually install the non-Python dependencies as described <a class="reference internal" href="../install.html#manual-install-rst"><span class="std std-ref">here</span></a>. This should be done BEFORE installing yggdrasil in the next step.</p>
<p>There are also two additional requirements files, <code class="docutils literal notranslate"><span class="pre">requirements_documentation.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">requirements_optional.txt</span></code>, that can optionally be added to the end of either of these commands. <code class="docutils literal notranslate"><span class="pre">requirements_documentation.txt</span></code> includes packages required for building the documentation and <code class="docutils literal notranslate"><span class="pre">requirements_optional.txt</span></code> includes packages required for optional yggdrasil features (e.g. using <code class="docutils literal notranslate"><span class="pre">astropy</span></code> table parsing or <code class="docutils literal notranslate"><span class="pre">pika</span></code> for RabbitMQ communication).</p>
</li>
<li><p>Run the yggdrasil installation script in development mode.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python setup.py develop
</pre></div>
</div>
</li>
<li><p>Run the yggdrasil configuration script.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ yggconfig
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Windows Users</strong> If you see the warning:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;WARNING: Did not find VS in registry or in VS140COMNTOOLS env var - your compiler may not work&quot;</span>
</pre></div>
</div>
<p>during installation you will need to run the command below to enable the Visual Studio command line tools.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ call &quot;C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat&quot; amd64
</pre></div>
</div>
<p>Then run <code class="docutils literal notranslate"><span class="pre">yggconfig</span></code> to finish the installation process for C and C++.</p>
</div>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>All development should be accompanied by tests. yggdrasil aims to
maintain 100% test coverage, so tests should be provided in pull
requests including new development. yggdrasil provides base classes to
aid in testing for most major classes (which is where development is
likely to occur). These are usually located in the tests directory within
the module directory containing the class being tested. In some cases
yggdrasil will automatically generate tests if certain class
attributes and/or methods are defined (e.g. serialization, communication,
and connection driver classes).</p>
<p>Tests can be run using the <code class="docutils literal notranslate"><span class="pre">yggtest</span></code> command. If no arguments are provided, <code class="docutils literal notranslate"><span class="pre">yggtest</span></code> will run all of the tests (excluding the examples). If you only want to run some tests, you can provide the path to file or directory containing the tests you would like to run; these paths can be absolute, relative to the current directory, or relative to the top level directory of the yggdrasil source tree. To also run example tests, include the <code class="docutils literal notranslate"><span class="pre">--with-examples</span></code> flag.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="release.html" class="btn btn-neutral float-right" title="Release Steps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Development" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017, Meagan Lang, David Raila.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>