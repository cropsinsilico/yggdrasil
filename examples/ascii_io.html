

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>ascii_io &mdash; yggdrasil v1.6.3+18.g537444084.dirty documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> yggdrasil
          

          
          </a>

          
            
            
              <div class="version">
                v1.6.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../includeme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formatted_io.html">Formatted I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_client_io.html">Server/Client I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autowrap.html">Autowrapping Model Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conditional_io.html">Conditional I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformed_io.html">Transformed I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timesync_io.html">Timestep Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yaml.html">YAML Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../c_format_strings.html">C-Style Format Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../threading.html">OpenMP Threading in Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples_toc.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Advanced</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon2018/index.html">Welcome to the 2018 Crops in Silico Hackathon!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon2019/index.html">Welcome to the 2019 Crops in Silico Hackathon!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon2021/index.html">Welcome to the 2021 Crops in Silico Hackathon!</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">yggdrasil</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>ascii_io</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/ascii_io.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ascii-io">
<span id="ascii-io-rst"></span><h1>ascii_io<a class="headerlink" href="#ascii-io" title="Permalink to this headline">¶</a></h1>
<p>A single model that receives data from three input files and sends received messages to three output files. The first file is an unstructure ASCII text file, the second file is a table delimited ASCII table that is read row by row, and the third file is a table identical to the second that is read all at once.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#mixed-version" id="id2">Mixed Version</a></p></li>
<li><p><a class="reference internal" href="#mixed-w-o-matlab-version" id="id3">Mixed w/o Matlab Version</a></p></li>
<li><p><a class="reference internal" href="#c-version" id="id4">C Version</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id5">C++ Version</a></p></li>
<li><p><a class="reference internal" href="#fortran-version" id="id6">Fortran Version</a></p></li>
<li><p><a class="reference internal" href="#matlab-version" id="id7">Matlab Version</a></p></li>
<li><p><a class="reference internal" href="#python-version" id="id8">Python Version</a></p></li>
<li><p><a class="reference internal" href="#r-version" id="id9">R Version</a></p></li>
</ul>
</div>
<div class="section" id="mixed-version">
<h2><a class="toc-backref" href="#id2">Mixed Version</a><a class="headerlink" href="#mixed-version" title="Permalink to this headline">¶</a></h2>
<p>Model Code:</p>
<div class="highlight-c notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="c1">// Include interface methods</span>
<span class="cp">#include</span> <span class="cpf">&quot;YggInterface.h&quot;</span><span class="cp"></span>

<span class="cp">#define BSIZE 8192 </span><span class="c1">// the max</span>



<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
  <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">error_code</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// Input &amp; output to an ASCII file line by line</span>
  <span class="n">yggAsciiFileInput_t</span> <span class="n">FileInput</span> <span class="o">=</span> <span class="n">yggAsciiFileInput</span><span class="p">(</span><span class="s">&quot;inputC_file&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiFileOutput_t</span> <span class="n">FileOutput</span> <span class="o">=</span> <span class="n">yggAsciiFileOutput</span><span class="p">(</span><span class="s">&quot;outputC_file&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table row by row</span>
  <span class="n">yggAsciiTableInput_t</span> <span class="n">TableInput</span> <span class="o">=</span> <span class="n">yggAsciiTableInput</span><span class="p">(</span><span class="s">&quot;inputC_table&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiTableOutput_t</span> <span class="n">TableOutput</span> <span class="o">=</span> <span class="n">yggAsciiTableOutput</span><span class="p">(</span><span class="s">&quot;outputC_table&quot;</span><span class="p">,</span>
							  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table as an array</span>
  <span class="n">yggAsciiArrayInput_t</span> <span class="n">ArrayInput</span> <span class="o">=</span> <span class="n">yggAsciiArrayInput</span><span class="p">(</span><span class="s">&quot;inputC_array&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiArrayOutput_t</span> <span class="n">ArrayOutput</span> <span class="o">=</span> <span class="n">yggAsciiArrayOutput</span><span class="p">(</span><span class="s">&quot;outputC_array&quot;</span><span class="p">,</span>
							  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

  <span class="c1">// Read lines from ASCII text file until end of file is reached.</span>
  <span class="c1">// As each line is received, it is then sent to the output ASCII file.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): Receiving/sending ASCII file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">line_size</span> <span class="o">=</span> <span class="n">LINE_SIZE_MAX</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">line_size</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">line_size</span> <span class="o">=</span> <span class="n">LINE_SIZE_MAX</span><span class="p">;</span> <span class="c1">// Reset to size of buffer</span>

    <span class="c1">// Receive a single line</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecvRealloc</span><span class="p">(</span><span class="n">FileInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">line</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">line_size</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the line to output</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;File: %s&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">FileOutput</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">line_size</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING LINE</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of file input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

  <span class="c1">// Read rows from ASCII table until end of file is reached.</span>
  <span class="c1">// As each row is received, it is then sent to the output ASCII table</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): Receiving/sending ASCII table.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">BSIZE</span><span class="p">];</span>
  <span class="kt">size_t</span> <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">number</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">value</span><span class="p">;</span>
  <span class="n">complex_double</span> <span class="n">comp</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span> <span class="c1">// Reset to size of the buffer</span>

    <span class="c1">// Receive a single row with values stored in scalars declared locally</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecv</span><span class="p">(</span><span class="n">TableInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp</span><span class="p">);</span>
		      
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the values to output. Formatting</span>
      <span class="c1">// is taken care of on the output driver side.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Table: %.5s, %ld, %3.1f, %g%+gj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
  	     <span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">creal</span><span class="p">(</span><span class="n">comp</span><span class="p">),</span> <span class="n">cimag</span><span class="p">(</span><span class="n">comp</span><span class="p">));</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">TableOutput</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_siz</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">comp</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING ROW</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of table input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Read entire array from ASCII table into columns that are dynamically</span>
  <span class="c1">// allocated. The returned values tells us the number of elements in the</span>
  <span class="c1">// columns.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Receiving/sending ASCII table as array.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">nrows</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">name_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">long</span> <span class="o">*</span><span class="n">number_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">double</span> <span class="o">*</span><span class="n">value_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">complex_double</span> <span class="o">*</span><span class="n">comp_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecvRealloc</span><span class="p">(</span><span class="n">ArrayInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nrows</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp_arr</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Array: (%lu rows)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="p">);</span>
      <span class="c1">// Print each line in the array</span>
      <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.5s, %ld, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">[</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">number_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
	       <span class="n">value_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">creal</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cimag</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
      <span class="c1">// Send the columns in the array to output. Formatting is handled on the</span>
      <span class="c1">// output driver side.</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">ArrayOutput</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">name_arr</span><span class="p">,</span> <span class="n">number_arr</span><span class="p">,</span> <span class="n">value_arr</span><span class="p">,</span> <span class="n">comp_arr</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING ARRAY</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of array input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
    
  <span class="c1">// Free dynamically allocated columns</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">name_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">number_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">number_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">value_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">value_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">comp_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">);</span>
  
  <span class="k">return</span> <span class="n">error_code</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="c1">// Include interface methods</span>
<span class="cp">#include</span> <span class="cpf">&quot;YggInterface.hpp&quot;</span><span class="cp"></span>

<span class="cp">#define BSIZE 8192 </span><span class="c1">// the max</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
  <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">error_code</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// Input &amp; output to an ASCII file line by line</span>
  <span class="n">YggAsciiFileInput</span> <span class="n">FileInput</span><span class="p">(</span><span class="s">&quot;inputCPP_file&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiFileOutput</span> <span class="n">FileOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_file&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table row by row</span>
  <span class="n">YggAsciiTableInput</span> <span class="n">TableInput</span><span class="p">(</span><span class="s">&quot;inputCPP_table&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiTableOutput</span> <span class="n">TableOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_table&quot;</span><span class="p">,</span>
                                  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table as an array</span>
  <span class="n">YggAsciiArrayInput</span> <span class="n">ArrayInput</span><span class="p">(</span><span class="s">&quot;inputCPP_array&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiArrayOutput</span> <span class="n">ArrayOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_array&quot;</span><span class="p">,</span>
				  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

  <span class="c1">// Read lines from ASCII text file until end of file is reached.</span>
  <span class="c1">// As each line is received, it is then sent to the output ASCII file.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): Receiving/sending ASCII file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">LINE_SIZE_MAX</span><span class="p">);</span>
  <span class="c1">// char line[LINE_SIZE_MAX];</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Receive a single line</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">FileInput</span><span class="p">.</span><span class="n">recv_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">LINE_SIZE_MAX</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the line to output</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;File: %s&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">FileOutput</span><span class="p">.</span><span class="n">send_line</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING LINE</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of file input (CPP)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="c1">// FileOutput.send_eof();</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">free</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

  <span class="c1">// Read rows from ASCII table until end of file is reached.</span>
  <span class="c1">// As each row is received, it is then sent to the output ASCII table</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): Receiving/sending ASCII table.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
  <span class="kt">size_t</span> <span class="o">*</span> <span class="k">const</span> <span class="n">p_name_siz</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">;</span> <span class="c1">// Required in C++ to get name size</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">BSIZE</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">number</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">value</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">comp</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>  <span class="c1">// Reset to buffer size</span>

    <span class="c1">// Receive a single row with values stored in scalars declared locally</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">TableInput</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp</span><span class="p">);</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the values to output. Formatting</span>
      <span class="c1">// is taken care of on the output driver side.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Table: %.5s, %d, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span>
  	     <span class="n">std</span><span class="o">::</span><span class="n">real</span><span class="p">(</span><span class="n">comp</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">imag</span><span class="p">(</span><span class="n">comp</span><span class="p">));</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">TableOutput</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_siz</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">comp</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING ROW</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of table input (CPP)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Read entire array from ASCII table into columns that are dynamically</span>
  <span class="c1">// allocated. The returned values tells us the number of elements in the</span>
  <span class="c1">// columns.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Receiving/sending ASCII table as array.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">nrows</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">name_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">long</span> <span class="o">*</span><span class="n">number_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">double</span> <span class="o">*</span><span class="n">value_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">comp_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">ArrayInput</span><span class="p">.</span><span class="n">recvRealloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nrows</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp_arr</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Array: (%lu rows)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="p">);</span>
      <span class="c1">// Print each line in the array</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.5s, %ld, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">[</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">number_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
  	       <span class="n">value_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std</span><span class="o">::</span><span class="n">real</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">std</span><span class="o">::</span><span class="n">imag</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
      <span class="c1">// Send the columns in the array to output. Formatting is handled on the</span>
      <span class="c1">// output driver side.</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">ArrayOutput</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">name_arr</span><span class="p">,</span> <span class="n">number_arr</span><span class="p">,</span> <span class="n">value_arr</span><span class="p">,</span> <span class="n">comp_arr</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING ARRAY</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of array input (C++)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span> 
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">// Free dynamically allocated columns</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">name_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">number_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">number_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">value_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">value_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">comp_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">error_code</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre></div></td><td class="code"><div class="highlight"><pre><span></span>program main
  ! Include interface methods
  use fygg

  integer, parameter :: BSIZE = 8192
  logical :: ret
  integer :: error_code = 0
  type(yggcomm) :: file_input, file_output, &amp;
       table_input, table_output, array_input, array_output
  integer(kind=c_size_t), target :: line_size = LINE_SIZE_MAX
  type(yggchar_r) :: line  ! Wrapped to be reallocatable
  character(len=BSIZE), target :: name
  integer(kind=c_size_t), target :: name_siz = BSIZE
  integer(kind=8) :: number
  real(kind=8) :: value
  complex(kind=8) :: comp
  integer(kind=c_size_t), target :: nrows
  type(character_1d), target :: name_arr
  type(integer8_1d), target :: number_arr
  type(real8_1d), target :: value_arr
  type(complex8_1d), target :: comp_arr
  integer(kind=c_size_t) :: i

  ! Input &amp; output to an ASCII file line by line
  file_input = ygg_ascii_file_input(&quot;inputF_file&quot;)
  file_output = ygg_ascii_file_output(&quot;outputF_file&quot;)
  ! Input &amp; output from a table row by row
  table_input = ygg_ascii_table_input(&quot;inputF_table&quot;)
  table_output = ygg_ascii_table_output(&quot;outputF_table&quot;, &amp;
       &quot;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&quot;)
  ! Input &amp; output from a table as an array
  array_input = ygg_ascii_array_input(&quot;inputF_array&quot;)
  array_output = ygg_ascii_array_output(&quot;outputF_array&quot;, &amp;
       &quot;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&quot;)

  ! Read lines from ASCII text file until end of file is reached.
  ! As each line is received, it is then sent to the output ASCII file.
  write(*, &#39;(&quot;ascii_io(F): Receiving/sending ASCII file.&quot;)&#39;)
  ret = .true.
  do while (ret)
     line_size = size(line%x)  ! Reset to size of buffer

     ! Receive a single line
     ret = ygg_recv_var_realloc(file_input, &amp;
          [yggarg(line), yggarg(line_size)])
     if (ret) then
        ! If the receive was succesful, send the line to output
        write(*, &#39;(&quot;File: &quot;,80A)&#39;, advance=&quot;no&quot;) line%x
        ret = ygg_send_var(file_output, &amp;
             [yggarg(line), yggarg(line_size)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING LINE&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        ! If the receive was not succesful, send the end-of-file message to
        ! close the output file.
        write(*, &#39;(&quot;End of file input (F)&quot;)&#39;)
     end if
  end do

  ! Read rows from ASCII table until end of file is reached.
  ! As each row is received, it is then sent to the output ASCII table
  write(*, &#39;(&quot;ascii_io(F): Receiving/sending ASCII table.&quot;)&#39;)
  ret = .true.
  do while (ret)
     name_siz = BSIZE  ! Reset to size of the buffer

     ! Receive a single row with values stored in scalars declared locally
     ret = ygg_recv_var(table_input, &amp;
          [yggarg(name), yggarg(name_siz), yggarg(number), &amp;
          yggarg(value), yggarg(comp)])

     if (ret) then
        ! If the receive was succesful, send the values to output. Formatting
        ! is taken care of on the output driver side.
        write (*, &#39;(&quot;Table: &quot;,A,&quot;, &quot;,I7,&quot;, &quot;,F10.5,&quot;, &quot;,2F10.5)&#39;) &amp;
             trim(name), number, value, comp
        ret = ygg_send_var(table_output, &amp;
             [yggarg(name), yggarg(name_siz), yggarg(number), &amp;
             yggarg(value), yggarg(comp)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING ROW&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        ! If the receive was not succesful, send the end-of-file message to
        ! close the output file.
        write(*, &#39;(&quot;End of table input (F)&quot;)&#39;)
     end if
  end do

  ! Read entire array from ASCII table into columns that are dynamically
  ! allocated. The returned values tells us the number of elements in the
  ! columns.
  write(*, &#39;(&quot;Receiving/sending ASCII table as array.&quot;)&#39;)
  ret = .true.
  do while (ret)
     ret = ygg_recv_var_realloc(array_input, [yggarg(nrows), &amp;
          yggarg(name_arr), yggarg(number_arr), &amp;
          yggarg(value_arr), yggarg(comp_arr)])
     if (ret) then
        write(*, &#39;(&quot;Array: (&quot;,I7,&quot; rows)&quot;)&#39;) nrows
        ! Print each line in the array
        do i = 1, nrows
           write(*, &#39;(5A)&#39;, advance=&quot;no&quot;) name_arr%x(i)%x
           write(*, &#39;(&quot;, &quot;,I7,&quot;, &quot;,F10.5,&quot;, &quot;,2F10.5)&#39;) &amp;
                number_arr%x(i), value_arr%x(i), comp_arr%x(i)
        end do
        ! Send the columns in the array to output. Formatting is handled on the
        ! output driver side.
        ret = ygg_send_var(array_output, [yggarg(nrows), &amp;
             yggarg(name_arr), yggarg(number_arr), &amp;
             yggarg(value_arr), yggarg(comp_arr)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING ARRAY&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        write(*, &#39;(&quot;End of array input (F)&quot;)&#39;)
     end if
  end do

  if (error_code.lt.0) then
     stop 1
  end if

end program main
</pre></div>
</td></tr></table></div>
<div class="highlight-matlab notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">% Input &amp; output to an ASCII file line by line </span>
<span class="n">in_file</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiFileInput&#39;</span><span class="p">,</span> <span class="s">&#39;inputM_file&#39;</span><span class="p">);</span>
<span class="n">out_file</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiFileOutput&#39;</span><span class="p">,</span> <span class="s">&#39;outputM_file&#39;</span><span class="p">);</span>
<span class="c">% Input &amp; output from a table row by row</span>
<span class="n">in_table</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiTableInput&#39;</span><span class="p">,</span> <span class="s">&#39;inputM_table&#39;</span><span class="p">);</span>
<span class="n">out_table</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiTableOutput&#39;</span><span class="p">,</span> <span class="s">&#39;outputM_table&#39;</span><span class="p">,</span> <span class="c">...</span>
			 <span class="s">&#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;</span><span class="p">);</span>
<span class="c">% Input &amp; output from a table as an array</span>
<span class="n">in_array</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiArrayInput&#39;</span><span class="p">,</span> <span class="s">&#39;inputM_array&#39;</span><span class="p">);</span>
<span class="n">out_array</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiArrayOutput&#39;</span><span class="p">,</span> <span class="s">&#39;outputM_array&#39;</span><span class="p">,</span> <span class="c">...</span>
			 <span class="s">&#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;</span><span class="p">);</span>

<span class="c">% Read lines from ASCII text file until end of file is reached.</span>
<span class="c">% As each line is received, it is then sent to the output ASCII file.</span>
<span class="nb">disp</span><span class="p">(</span><span class="s">&#39;ascii_io(M): Receiving/sending ASCII file.&#39;</span><span class="p">);</span>
<span class="n">flag</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span>
<span class="k">while</span> <span class="n">flag</span>
  <span class="c">% Receive a single line</span>
  <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">line</span><span class="p">]</span> <span class="p">=</span> <span class="n">in_file</span><span class="p">.</span><span class="n">recv</span><span class="p">();</span>
  <span class="k">if</span> <span class="n">flag</span>
    <span class="c">% If the receive was succesful, send the line to output</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;File: %s&#39;</span><span class="p">,</span> <span class="n">char</span><span class="p">(</span><span class="n">line</span><span class="p">));</span>
    <span class="n">ret</span> <span class="p">=</span> <span class="n">out_file</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">ret</span><span class="p">);</span>
      <span class="n">error</span><span class="p">(</span><span class="s">&#39;ascii_io(M): ERROR SENDING LINE&#39;</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">end</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="c">% If the receive was not succesful, send the end-of-file message to</span>
    <span class="c">% close the output file. </span>
    <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;End of file input (Matlab)&#39;</span><span class="p">);</span>
    <span class="n">out_file</span><span class="p">.</span><span class="n">send_eof</span><span class="p">();</span>
  <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="c">% Read rows from ASCII table until end of file is reached.</span>
<span class="c">% As each row is received, it is then sent to the output ASCII table</span>
<span class="n">flag</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span>
<span class="k">while</span> <span class="n">flag</span>
  <span class="c">% Receive a single row</span>
  <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">line</span><span class="p">]</span> <span class="p">=</span> <span class="n">in_table</span><span class="p">.</span><span class="n">recv</span><span class="p">();</span>
  <span class="k">if</span> <span class="n">flag</span>
    <span class="c">% If the receive was succesful, send the values to output.</span>
    <span class="c">% Formatting is taken care of on the output driver side.</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Table: %s, %d, %3.1f, %3.1f%+3.1fi\n&#39;</span><span class="p">,</span> <span class="n">char</span><span class="p">(</span><span class="n">line</span><span class="p">{</span><span class="mi">1</span><span class="p">}),</span> <span class="c">...</span>
	    <span class="n">line</span><span class="p">{</span><span class="mi">2</span><span class="p">},</span> <span class="n">line</span><span class="p">{</span><span class="mi">3</span><span class="p">},</span> <span class="nb">real</span><span class="p">(</span><span class="n">line</span><span class="p">{</span><span class="mi">4</span><span class="p">}),</span> <span class="nb">imag</span><span class="p">(</span><span class="n">line</span><span class="p">{</span><span class="mi">4</span><span class="p">}));</span>
    <span class="n">ret</span> <span class="p">=</span> <span class="n">out_table</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">ret</span><span class="p">);</span>
      <span class="n">error</span><span class="p">(</span><span class="s">&#39;ascii_io(M): ERROR SENDING ROW&#39;</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">end</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="c">% If the receive was not succesful, send the end-of-file message to</span>
    <span class="c">% close the output file.</span>
    <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;End of table input (Matlab)&#39;</span><span class="p">);</span>
    <span class="n">out_table</span><span class="p">.</span><span class="n">send_eof</span><span class="p">();</span>
  <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="c">% Read entire array from ASCII table into an array</span>
<span class="n">flag</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span>
<span class="k">while</span> <span class="n">flag</span>
  <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">arr</span><span class="p">]</span> <span class="p">=</span> <span class="n">in_array</span><span class="p">.</span><span class="n">recv_array</span><span class="p">();</span>
  <span class="k">if</span> <span class="n">flag</span>
    <span class="n">nr</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Array: (%d rows)\n&#39;</span><span class="p">,</span> <span class="n">nr</span><span class="p">);</span>
    <span class="c">% Print each line in the array</span>
    <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">nr</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;%5s, %d, %3.1f, %3.1f%+3.1fi\n&#39;</span><span class="p">,</span> <span class="c">...</span>
              <span class="n">char</span><span class="p">(</span><span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">1</span><span class="p">}),</span> <span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span> <span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span> <span class="c">...</span>
              <span class="nb">real</span><span class="p">(</span><span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">4</span><span class="p">}),</span> <span class="nb">imag</span><span class="p">(</span><span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">4</span><span class="p">}));</span>
    <span class="k">end</span><span class="p">;</span>
    <span class="c">% Send the array to output. Formatting is handled on the output driver side.</span>
    <span class="n">ret</span> <span class="p">=</span> <span class="n">out_array</span><span class="p">.</span><span class="n">send_array</span><span class="p">(</span><span class="n">arr</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">ret</span><span class="p">);</span>
      <span class="n">error</span><span class="p">(</span><span class="s">&#39;ascii_io(M): ERROR SENDING ARRAY&#39;</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">end</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="c">% If the receive was not succesful, send the end-of-file message to</span>
    <span class="c">% close the output file.</span>
    <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;End of array input (Matlab)&#39;</span><span class="p">);</span>
  <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="c1"># Import necessary connection interfaces</span>
<span class="kn">from</span> <span class="nn">yggdrasil.tools</span> <span class="kn">import</span> <span class="n">print_encoded</span>
<span class="kn">from</span> <span class="nn">yggdrasil.interface.YggInterface</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">YggAsciiFileInput</span><span class="p">,</span> <span class="n">YggAsciiFileOutput</span><span class="p">,</span>
    <span class="n">YggAsciiTableInput</span><span class="p">,</span> <span class="n">YggAsciiTableOutput</span><span class="p">,</span>
    <span class="n">YggAsciiArrayInput</span><span class="p">,</span> <span class="n">YggAsciiArrayOutput</span><span class="p">)</span>

    
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="c1"># Input &amp; output to an ASCII file line by line</span>
    <span class="n">in_file</span> <span class="o">=</span> <span class="n">YggAsciiFileInput</span><span class="p">(</span><span class="s1">&#39;inputPy_file&#39;</span><span class="p">)</span>
    <span class="n">out_file</span> <span class="o">=</span> <span class="n">YggAsciiFileOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_file&#39;</span><span class="p">)</span>
    <span class="c1"># Input &amp; output from a table row by row</span>
    <span class="n">in_table</span> <span class="o">=</span> <span class="n">YggAsciiTableInput</span><span class="p">(</span><span class="s1">&#39;inputPy_table&#39;</span><span class="p">)</span>
    <span class="n">out_table</span> <span class="o">=</span> <span class="n">YggAsciiTableOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_table&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;</span><span class="si">%5s</span><span class="se">\t</span><span class="si">%ld</span><span class="se">\t</span><span class="si">%3.1f</span><span class="se">\t</span><span class="si">%3.1lf%+3.1lf</span><span class="s1">j</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># Input &amp; output from a table as an array</span>
    <span class="n">in_array</span> <span class="o">=</span> <span class="n">YggAsciiArrayInput</span><span class="p">(</span><span class="s1">&#39;inputPy_array&#39;</span><span class="p">)</span>
    <span class="n">out_array</span> <span class="o">=</span> <span class="n">YggAsciiArrayOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_array&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;</span><span class="si">%5s</span><span class="se">\t</span><span class="si">%ld</span><span class="se">\t</span><span class="si">%3.1f</span><span class="se">\t</span><span class="si">%3.1lf%+3.1lf</span><span class="s1">j</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Read lines from ASCII text file until end of file is reached.</span>
    <span class="c1"># As each line is received, it is then sent to the output ASCII file.</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ascii_io(P): Receiving/sending ASCII file.&#39;</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="c1"># Receive a single line</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="c1"># If the receive was succesful, send the line to output</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;File: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_file</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING LINE&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the receive was not succesful, send the end-of-file message to</span>
            <span class="c1"># close the output file.</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;End of file input (Python)&quot;</span><span class="p">)</span>
            <span class="n">out_file</span><span class="o">.</span><span class="n">send_eof</span><span class="p">()</span>

    <span class="c1"># Read rows from ASCII table until end of file is reached.</span>
    <span class="c1"># As each row is received, it is then sent to the output ASCII table</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ascii_io(P): Receiving/sending ASCII table.&#39;</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="c1"># Receive a single row</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="o">=</span> <span class="n">in_table</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="c1"># If the receive was succesful, send the values to output.</span>
            <span class="c1"># Formatting is taken care of on the output driver side.</span>
            <span class="n">print_encoded</span><span class="p">(</span><span class="s2">&quot;Table: </span><span class="si">%s</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%3.1f</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
            <span class="c1"># print(&quot;Table: %s, %d, %3.1f, %s&quot; % line)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_table</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING ROW&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the receive was not succesful, send the end-of-file message to</span>
            <span class="c1"># close the output file.</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;End of table input (Python)&quot;</span><span class="p">)</span>
            <span class="n">out_table</span><span class="o">.</span><span class="n">send_eof</span><span class="p">()</span>

    <span class="c1"># Read entire array from ASCII table into numpy array</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">,</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">in_array</span><span class="o">.</span><span class="n">recv_array</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Array: (</span><span class="si">%d</span><span class="s2"> rows)&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
            <span class="c1"># Print each line in the array</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)):</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%5s</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%3.1f</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="c1"># Send the array to output. Formatting is handled on the output driver side.</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_array</span><span class="o">.</span><span class="n">send_array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING ARRAY&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): End of array input (Python)&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79</pre></div></td><td class="code"><div class="highlight"><pre><span></span>library(yggdrasil)

# Input &amp; output to an ASCII file line by line
in_file &lt;- YggInterface(&#39;YggAsciiFileInput&#39;, &#39;inputR_file&#39;)
out_file &lt;- YggInterface(&#39;YggAsciiFileOutput&#39;, &#39;outputR_file&#39;)
# Input &amp; output from a table row by row
in_table &lt;- YggInterface(&#39;YggAsciiTableInput&#39;, &#39;inputR_table&#39;)
out_table &lt;- YggInterface(&#39;YggAsciiTableOutput&#39;, &#39;outputR_table&#39;,
                          &#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;)
# Input &amp; output from a table as an array
in_array &lt;- YggInterface(&#39;YggAsciiArrayInput&#39;, &#39;inputR_array&#39;)
out_array &lt;- YggInterface(&#39;YggAsciiArrayOutput&#39;, &#39;outputR_array&#39;,
                          &#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;)

# Read lines from ASCII text file until end of file is reached.
# As each line is received, it is then sent to the output ASCII file.
print(&#39;ascii_io(R): Receiving/sending ASCII file.&#39;)
ret = TRUE
while (ret) {
  # Receive a single line
  c(ret, line) %&lt;-% in_file$recv()
  if (ret) {
    # If the receive was succesful, send the line to output
    fprintf(&#39;File: %s&#39;, line)
    ret &lt;- out_file$send(line)
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING LINE&quot;)
    }
  } else {
    # If the receive was not succesful, send the end-of-file message to
    # close the output file.
    print(&quot;End of file input (R)&quot;)
    out_file$send_eof()
  }
}

# Read rows from ASCII table until end of file is reached.
# As each row is received, it is then sent to the output ASCII table
print(&#39;ascii_io(R): Receiving/sending ASCII table.&#39;)
ret &lt;- TRUE
while (ret) {
  # Receive a single row
  c(ret, line) %&lt;-% in_table$recv()
  if (ret) {
    # If the receive was succesful, send the values to output.
    # Formatting is taken care of on the output driver side.
    fprintf(&quot;Table: %s, %d, %3.1f, %s&quot;, line[[1]], line[[2]], line[[3]], line[[4]])
    ret &lt;- out_table$send(line[[1]], line[[2]], line[[3]], line[[4]])
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING ROW&quot;)
    }
  } else {
    # If the receive was not succesful, send the end-of-file message to
    # close the output file.
    print(&quot;End of table input (R)&quot;)
    out_table$send_eof()
  }
}

# Read entire array from ASCII table into numpy array
ret &lt;- TRUE
while (ret) {
  c(ret, arr) %&lt;-% in_array$recv_array()
  if (ret) {
    fprintf(&quot;Array: (%d rows)&quot;, length(arr))
    # Print each line in the array
    for (i in 1:length(arr)) {
      fprintf(&quot;%5s, %d, %3.1f, %s&quot;,
              arr[[i]][[1]], arr[[i]][[2]], arr[[i]][[3]], arr[[i]][[4]])
    }
    # Send the array to output. Formatting is handled on the output driver side.
    ret &lt;- out_array$send_array(arr)
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING ARRAY&quot;)
    }
  } else {
    print(&quot;ascii_io(R): End of array input (R)&quot;)
  }
}
</pre></div>
</td></tr></table></div>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">models</span><span class="p">:</span>
  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_GCC</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GCCModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.c</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileInputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_file.txt</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_table.txt</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_array.txt</span>
        <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_table</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_array</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_Fortran</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FortranModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.f90</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_table</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_array</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_table</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_array</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_Python</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PythonModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.py</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_table</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_array</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_table</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_array</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_CPP</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GCCModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.cpp</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_table</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_array</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_table</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_array</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_Matlab</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MatlabModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.m</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputM_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputM_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_table</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputM_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_array</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputM_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileOutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_file.txt</span>
        <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputM_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_table.txt</span>
        <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputM_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_array.txt</span>
        <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="mixed-w-o-matlab-version">
<h2><a class="toc-backref" href="#id3">Mixed w/o Matlab Version</a><a class="headerlink" href="#mixed-w-o-matlab-version" title="Permalink to this headline">¶</a></h2>
<p>Model Code:</p>
<div class="highlight-c notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="c1">// Include interface methods</span>
<span class="cp">#include</span> <span class="cpf">&quot;YggInterface.h&quot;</span><span class="cp"></span>

<span class="cp">#define BSIZE 8192 </span><span class="c1">// the max</span>



<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
  <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">error_code</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// Input &amp; output to an ASCII file line by line</span>
  <span class="n">yggAsciiFileInput_t</span> <span class="n">FileInput</span> <span class="o">=</span> <span class="n">yggAsciiFileInput</span><span class="p">(</span><span class="s">&quot;inputC_file&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiFileOutput_t</span> <span class="n">FileOutput</span> <span class="o">=</span> <span class="n">yggAsciiFileOutput</span><span class="p">(</span><span class="s">&quot;outputC_file&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table row by row</span>
  <span class="n">yggAsciiTableInput_t</span> <span class="n">TableInput</span> <span class="o">=</span> <span class="n">yggAsciiTableInput</span><span class="p">(</span><span class="s">&quot;inputC_table&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiTableOutput_t</span> <span class="n">TableOutput</span> <span class="o">=</span> <span class="n">yggAsciiTableOutput</span><span class="p">(</span><span class="s">&quot;outputC_table&quot;</span><span class="p">,</span>
							  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table as an array</span>
  <span class="n">yggAsciiArrayInput_t</span> <span class="n">ArrayInput</span> <span class="o">=</span> <span class="n">yggAsciiArrayInput</span><span class="p">(</span><span class="s">&quot;inputC_array&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiArrayOutput_t</span> <span class="n">ArrayOutput</span> <span class="o">=</span> <span class="n">yggAsciiArrayOutput</span><span class="p">(</span><span class="s">&quot;outputC_array&quot;</span><span class="p">,</span>
							  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

  <span class="c1">// Read lines from ASCII text file until end of file is reached.</span>
  <span class="c1">// As each line is received, it is then sent to the output ASCII file.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): Receiving/sending ASCII file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">line_size</span> <span class="o">=</span> <span class="n">LINE_SIZE_MAX</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">line_size</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">line_size</span> <span class="o">=</span> <span class="n">LINE_SIZE_MAX</span><span class="p">;</span> <span class="c1">// Reset to size of buffer</span>

    <span class="c1">// Receive a single line</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecvRealloc</span><span class="p">(</span><span class="n">FileInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">line</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">line_size</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the line to output</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;File: %s&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">FileOutput</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">line_size</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING LINE</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of file input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

  <span class="c1">// Read rows from ASCII table until end of file is reached.</span>
  <span class="c1">// As each row is received, it is then sent to the output ASCII table</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): Receiving/sending ASCII table.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">BSIZE</span><span class="p">];</span>
  <span class="kt">size_t</span> <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">number</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">value</span><span class="p">;</span>
  <span class="n">complex_double</span> <span class="n">comp</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span> <span class="c1">// Reset to size of the buffer</span>

    <span class="c1">// Receive a single row with values stored in scalars declared locally</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecv</span><span class="p">(</span><span class="n">TableInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp</span><span class="p">);</span>
		      
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the values to output. Formatting</span>
      <span class="c1">// is taken care of on the output driver side.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Table: %.5s, %ld, %3.1f, %g%+gj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
  	     <span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">creal</span><span class="p">(</span><span class="n">comp</span><span class="p">),</span> <span class="n">cimag</span><span class="p">(</span><span class="n">comp</span><span class="p">));</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">TableOutput</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_siz</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">comp</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING ROW</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of table input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Read entire array from ASCII table into columns that are dynamically</span>
  <span class="c1">// allocated. The returned values tells us the number of elements in the</span>
  <span class="c1">// columns.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Receiving/sending ASCII table as array.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">nrows</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">name_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">long</span> <span class="o">*</span><span class="n">number_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">double</span> <span class="o">*</span><span class="n">value_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">complex_double</span> <span class="o">*</span><span class="n">comp_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecvRealloc</span><span class="p">(</span><span class="n">ArrayInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nrows</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp_arr</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Array: (%lu rows)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="p">);</span>
      <span class="c1">// Print each line in the array</span>
      <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.5s, %ld, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">[</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">number_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
	       <span class="n">value_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">creal</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cimag</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
      <span class="c1">// Send the columns in the array to output. Formatting is handled on the</span>
      <span class="c1">// output driver side.</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">ArrayOutput</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">name_arr</span><span class="p">,</span> <span class="n">number_arr</span><span class="p">,</span> <span class="n">value_arr</span><span class="p">,</span> <span class="n">comp_arr</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING ARRAY</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of array input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
    
  <span class="c1">// Free dynamically allocated columns</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">name_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">number_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">number_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">value_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">value_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">comp_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">);</span>
  
  <span class="k">return</span> <span class="n">error_code</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="c1">// Include interface methods</span>
<span class="cp">#include</span> <span class="cpf">&quot;YggInterface.hpp&quot;</span><span class="cp"></span>

<span class="cp">#define BSIZE 8192 </span><span class="c1">// the max</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
  <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">error_code</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// Input &amp; output to an ASCII file line by line</span>
  <span class="n">YggAsciiFileInput</span> <span class="n">FileInput</span><span class="p">(</span><span class="s">&quot;inputCPP_file&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiFileOutput</span> <span class="n">FileOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_file&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table row by row</span>
  <span class="n">YggAsciiTableInput</span> <span class="n">TableInput</span><span class="p">(</span><span class="s">&quot;inputCPP_table&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiTableOutput</span> <span class="n">TableOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_table&quot;</span><span class="p">,</span>
                                  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table as an array</span>
  <span class="n">YggAsciiArrayInput</span> <span class="n">ArrayInput</span><span class="p">(</span><span class="s">&quot;inputCPP_array&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiArrayOutput</span> <span class="n">ArrayOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_array&quot;</span><span class="p">,</span>
				  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

  <span class="c1">// Read lines from ASCII text file until end of file is reached.</span>
  <span class="c1">// As each line is received, it is then sent to the output ASCII file.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): Receiving/sending ASCII file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">LINE_SIZE_MAX</span><span class="p">);</span>
  <span class="c1">// char line[LINE_SIZE_MAX];</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Receive a single line</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">FileInput</span><span class="p">.</span><span class="n">recv_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">LINE_SIZE_MAX</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the line to output</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;File: %s&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">FileOutput</span><span class="p">.</span><span class="n">send_line</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING LINE</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of file input (CPP)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="c1">// FileOutput.send_eof();</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">free</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

  <span class="c1">// Read rows from ASCII table until end of file is reached.</span>
  <span class="c1">// As each row is received, it is then sent to the output ASCII table</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): Receiving/sending ASCII table.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
  <span class="kt">size_t</span> <span class="o">*</span> <span class="k">const</span> <span class="n">p_name_siz</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">;</span> <span class="c1">// Required in C++ to get name size</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">BSIZE</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">number</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">value</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">comp</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>  <span class="c1">// Reset to buffer size</span>

    <span class="c1">// Receive a single row with values stored in scalars declared locally</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">TableInput</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp</span><span class="p">);</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the values to output. Formatting</span>
      <span class="c1">// is taken care of on the output driver side.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Table: %.5s, %d, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span>
  	     <span class="n">std</span><span class="o">::</span><span class="n">real</span><span class="p">(</span><span class="n">comp</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">imag</span><span class="p">(</span><span class="n">comp</span><span class="p">));</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">TableOutput</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_siz</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">comp</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING ROW</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of table input (CPP)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Read entire array from ASCII table into columns that are dynamically</span>
  <span class="c1">// allocated. The returned values tells us the number of elements in the</span>
  <span class="c1">// columns.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Receiving/sending ASCII table as array.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">nrows</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">name_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">long</span> <span class="o">*</span><span class="n">number_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">double</span> <span class="o">*</span><span class="n">value_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">comp_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">ArrayInput</span><span class="p">.</span><span class="n">recvRealloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nrows</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp_arr</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Array: (%lu rows)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="p">);</span>
      <span class="c1">// Print each line in the array</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.5s, %ld, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">[</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">number_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
  	       <span class="n">value_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std</span><span class="o">::</span><span class="n">real</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">std</span><span class="o">::</span><span class="n">imag</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
      <span class="c1">// Send the columns in the array to output. Formatting is handled on the</span>
      <span class="c1">// output driver side.</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">ArrayOutput</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">name_arr</span><span class="p">,</span> <span class="n">number_arr</span><span class="p">,</span> <span class="n">value_arr</span><span class="p">,</span> <span class="n">comp_arr</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING ARRAY</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of array input (C++)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span> 
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">// Free dynamically allocated columns</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">name_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">number_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">number_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">value_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">value_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">comp_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">error_code</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre></div></td><td class="code"><div class="highlight"><pre><span></span>program main
  ! Include interface methods
  use fygg

  integer, parameter :: BSIZE = 8192
  logical :: ret
  integer :: error_code = 0
  type(yggcomm) :: file_input, file_output, &amp;
       table_input, table_output, array_input, array_output
  integer(kind=c_size_t), target :: line_size = LINE_SIZE_MAX
  type(yggchar_r) :: line  ! Wrapped to be reallocatable
  character(len=BSIZE), target :: name
  integer(kind=c_size_t), target :: name_siz = BSIZE
  integer(kind=8) :: number
  real(kind=8) :: value
  complex(kind=8) :: comp
  integer(kind=c_size_t), target :: nrows
  type(character_1d), target :: name_arr
  type(integer8_1d), target :: number_arr
  type(real8_1d), target :: value_arr
  type(complex8_1d), target :: comp_arr
  integer(kind=c_size_t) :: i

  ! Input &amp; output to an ASCII file line by line
  file_input = ygg_ascii_file_input(&quot;inputF_file&quot;)
  file_output = ygg_ascii_file_output(&quot;outputF_file&quot;)
  ! Input &amp; output from a table row by row
  table_input = ygg_ascii_table_input(&quot;inputF_table&quot;)
  table_output = ygg_ascii_table_output(&quot;outputF_table&quot;, &amp;
       &quot;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&quot;)
  ! Input &amp; output from a table as an array
  array_input = ygg_ascii_array_input(&quot;inputF_array&quot;)
  array_output = ygg_ascii_array_output(&quot;outputF_array&quot;, &amp;
       &quot;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&quot;)

  ! Read lines from ASCII text file until end of file is reached.
  ! As each line is received, it is then sent to the output ASCII file.
  write(*, &#39;(&quot;ascii_io(F): Receiving/sending ASCII file.&quot;)&#39;)
  ret = .true.
  do while (ret)
     line_size = size(line%x)  ! Reset to size of buffer

     ! Receive a single line
     ret = ygg_recv_var_realloc(file_input, &amp;
          [yggarg(line), yggarg(line_size)])
     if (ret) then
        ! If the receive was succesful, send the line to output
        write(*, &#39;(&quot;File: &quot;,80A)&#39;, advance=&quot;no&quot;) line%x
        ret = ygg_send_var(file_output, &amp;
             [yggarg(line), yggarg(line_size)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING LINE&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        ! If the receive was not succesful, send the end-of-file message to
        ! close the output file.
        write(*, &#39;(&quot;End of file input (F)&quot;)&#39;)
     end if
  end do

  ! Read rows from ASCII table until end of file is reached.
  ! As each row is received, it is then sent to the output ASCII table
  write(*, &#39;(&quot;ascii_io(F): Receiving/sending ASCII table.&quot;)&#39;)
  ret = .true.
  do while (ret)
     name_siz = BSIZE  ! Reset to size of the buffer

     ! Receive a single row with values stored in scalars declared locally
     ret = ygg_recv_var(table_input, &amp;
          [yggarg(name), yggarg(name_siz), yggarg(number), &amp;
          yggarg(value), yggarg(comp)])

     if (ret) then
        ! If the receive was succesful, send the values to output. Formatting
        ! is taken care of on the output driver side.
        write (*, &#39;(&quot;Table: &quot;,A,&quot;, &quot;,I7,&quot;, &quot;,F10.5,&quot;, &quot;,2F10.5)&#39;) &amp;
             trim(name), number, value, comp
        ret = ygg_send_var(table_output, &amp;
             [yggarg(name), yggarg(name_siz), yggarg(number), &amp;
             yggarg(value), yggarg(comp)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING ROW&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        ! If the receive was not succesful, send the end-of-file message to
        ! close the output file.
        write(*, &#39;(&quot;End of table input (F)&quot;)&#39;)
     end if
  end do

  ! Read entire array from ASCII table into columns that are dynamically
  ! allocated. The returned values tells us the number of elements in the
  ! columns.
  write(*, &#39;(&quot;Receiving/sending ASCII table as array.&quot;)&#39;)
  ret = .true.
  do while (ret)
     ret = ygg_recv_var_realloc(array_input, [yggarg(nrows), &amp;
          yggarg(name_arr), yggarg(number_arr), &amp;
          yggarg(value_arr), yggarg(comp_arr)])
     if (ret) then
        write(*, &#39;(&quot;Array: (&quot;,I7,&quot; rows)&quot;)&#39;) nrows
        ! Print each line in the array
        do i = 1, nrows
           write(*, &#39;(5A)&#39;, advance=&quot;no&quot;) name_arr%x(i)%x
           write(*, &#39;(&quot;, &quot;,I7,&quot;, &quot;,F10.5,&quot;, &quot;,2F10.5)&#39;) &amp;
                number_arr%x(i), value_arr%x(i), comp_arr%x(i)
        end do
        ! Send the columns in the array to output. Formatting is handled on the
        ! output driver side.
        ret = ygg_send_var(array_output, [yggarg(nrows), &amp;
             yggarg(name_arr), yggarg(number_arr), &amp;
             yggarg(value_arr), yggarg(comp_arr)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING ARRAY&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        write(*, &#39;(&quot;End of array input (F)&quot;)&#39;)
     end if
  end do

  if (error_code.lt.0) then
     stop 1
  end if

end program main
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="c1"># Import necessary connection interfaces</span>
<span class="kn">from</span> <span class="nn">yggdrasil.tools</span> <span class="kn">import</span> <span class="n">print_encoded</span>
<span class="kn">from</span> <span class="nn">yggdrasil.interface.YggInterface</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">YggAsciiFileInput</span><span class="p">,</span> <span class="n">YggAsciiFileOutput</span><span class="p">,</span>
    <span class="n">YggAsciiTableInput</span><span class="p">,</span> <span class="n">YggAsciiTableOutput</span><span class="p">,</span>
    <span class="n">YggAsciiArrayInput</span><span class="p">,</span> <span class="n">YggAsciiArrayOutput</span><span class="p">)</span>

    
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="c1"># Input &amp; output to an ASCII file line by line</span>
    <span class="n">in_file</span> <span class="o">=</span> <span class="n">YggAsciiFileInput</span><span class="p">(</span><span class="s1">&#39;inputPy_file&#39;</span><span class="p">)</span>
    <span class="n">out_file</span> <span class="o">=</span> <span class="n">YggAsciiFileOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_file&#39;</span><span class="p">)</span>
    <span class="c1"># Input &amp; output from a table row by row</span>
    <span class="n">in_table</span> <span class="o">=</span> <span class="n">YggAsciiTableInput</span><span class="p">(</span><span class="s1">&#39;inputPy_table&#39;</span><span class="p">)</span>
    <span class="n">out_table</span> <span class="o">=</span> <span class="n">YggAsciiTableOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_table&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;</span><span class="si">%5s</span><span class="se">\t</span><span class="si">%ld</span><span class="se">\t</span><span class="si">%3.1f</span><span class="se">\t</span><span class="si">%3.1lf%+3.1lf</span><span class="s1">j</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># Input &amp; output from a table as an array</span>
    <span class="n">in_array</span> <span class="o">=</span> <span class="n">YggAsciiArrayInput</span><span class="p">(</span><span class="s1">&#39;inputPy_array&#39;</span><span class="p">)</span>
    <span class="n">out_array</span> <span class="o">=</span> <span class="n">YggAsciiArrayOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_array&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;</span><span class="si">%5s</span><span class="se">\t</span><span class="si">%ld</span><span class="se">\t</span><span class="si">%3.1f</span><span class="se">\t</span><span class="si">%3.1lf%+3.1lf</span><span class="s1">j</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Read lines from ASCII text file until end of file is reached.</span>
    <span class="c1"># As each line is received, it is then sent to the output ASCII file.</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ascii_io(P): Receiving/sending ASCII file.&#39;</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="c1"># Receive a single line</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="c1"># If the receive was succesful, send the line to output</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;File: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_file</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING LINE&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the receive was not succesful, send the end-of-file message to</span>
            <span class="c1"># close the output file.</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;End of file input (Python)&quot;</span><span class="p">)</span>
            <span class="n">out_file</span><span class="o">.</span><span class="n">send_eof</span><span class="p">()</span>

    <span class="c1"># Read rows from ASCII table until end of file is reached.</span>
    <span class="c1"># As each row is received, it is then sent to the output ASCII table</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ascii_io(P): Receiving/sending ASCII table.&#39;</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="c1"># Receive a single row</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="o">=</span> <span class="n">in_table</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="c1"># If the receive was succesful, send the values to output.</span>
            <span class="c1"># Formatting is taken care of on the output driver side.</span>
            <span class="n">print_encoded</span><span class="p">(</span><span class="s2">&quot;Table: </span><span class="si">%s</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%3.1f</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
            <span class="c1"># print(&quot;Table: %s, %d, %3.1f, %s&quot; % line)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_table</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING ROW&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the receive was not succesful, send the end-of-file message to</span>
            <span class="c1"># close the output file.</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;End of table input (Python)&quot;</span><span class="p">)</span>
            <span class="n">out_table</span><span class="o">.</span><span class="n">send_eof</span><span class="p">()</span>

    <span class="c1"># Read entire array from ASCII table into numpy array</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">,</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">in_array</span><span class="o">.</span><span class="n">recv_array</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Array: (</span><span class="si">%d</span><span class="s2"> rows)&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
            <span class="c1"># Print each line in the array</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)):</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%5s</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%3.1f</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="c1"># Send the array to output. Formatting is handled on the output driver side.</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_array</span><span class="o">.</span><span class="n">send_array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING ARRAY&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): End of array input (Python)&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79</pre></div></td><td class="code"><div class="highlight"><pre><span></span>library(yggdrasil)

# Input &amp; output to an ASCII file line by line
in_file &lt;- YggInterface(&#39;YggAsciiFileInput&#39;, &#39;inputR_file&#39;)
out_file &lt;- YggInterface(&#39;YggAsciiFileOutput&#39;, &#39;outputR_file&#39;)
# Input &amp; output from a table row by row
in_table &lt;- YggInterface(&#39;YggAsciiTableInput&#39;, &#39;inputR_table&#39;)
out_table &lt;- YggInterface(&#39;YggAsciiTableOutput&#39;, &#39;outputR_table&#39;,
                          &#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;)
# Input &amp; output from a table as an array
in_array &lt;- YggInterface(&#39;YggAsciiArrayInput&#39;, &#39;inputR_array&#39;)
out_array &lt;- YggInterface(&#39;YggAsciiArrayOutput&#39;, &#39;outputR_array&#39;,
                          &#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;)

# Read lines from ASCII text file until end of file is reached.
# As each line is received, it is then sent to the output ASCII file.
print(&#39;ascii_io(R): Receiving/sending ASCII file.&#39;)
ret = TRUE
while (ret) {
  # Receive a single line
  c(ret, line) %&lt;-% in_file$recv()
  if (ret) {
    # If the receive was succesful, send the line to output
    fprintf(&#39;File: %s&#39;, line)
    ret &lt;- out_file$send(line)
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING LINE&quot;)
    }
  } else {
    # If the receive was not succesful, send the end-of-file message to
    # close the output file.
    print(&quot;End of file input (R)&quot;)
    out_file$send_eof()
  }
}

# Read rows from ASCII table until end of file is reached.
# As each row is received, it is then sent to the output ASCII table
print(&#39;ascii_io(R): Receiving/sending ASCII table.&#39;)
ret &lt;- TRUE
while (ret) {
  # Receive a single row
  c(ret, line) %&lt;-% in_table$recv()
  if (ret) {
    # If the receive was succesful, send the values to output.
    # Formatting is taken care of on the output driver side.
    fprintf(&quot;Table: %s, %d, %3.1f, %s&quot;, line[[1]], line[[2]], line[[3]], line[[4]])
    ret &lt;- out_table$send(line[[1]], line[[2]], line[[3]], line[[4]])
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING ROW&quot;)
    }
  } else {
    # If the receive was not succesful, send the end-of-file message to
    # close the output file.
    print(&quot;End of table input (R)&quot;)
    out_table$send_eof()
  }
}

# Read entire array from ASCII table into numpy array
ret &lt;- TRUE
while (ret) {
  c(ret, arr) %&lt;-% in_array$recv_array()
  if (ret) {
    fprintf(&quot;Array: (%d rows)&quot;, length(arr))
    # Print each line in the array
    for (i in 1:length(arr)) {
      fprintf(&quot;%5s, %d, %3.1f, %s&quot;,
              arr[[i]][[1]], arr[[i]][[2]], arr[[i]][[3]], arr[[i]][[4]])
    }
    # Send the array to output. Formatting is handled on the output driver side.
    ret &lt;- out_array$send_array(arr)
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING ARRAY&quot;)
    }
  } else {
    print(&quot;ascii_io(R): End of array input (R)&quot;)
  }
}
</pre></div>
</td></tr></table></div>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">models</span><span class="p">:</span>
  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_GCC</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GCCModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.c</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileInputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_file.txt</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_table.txt</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_array.txt</span>
        <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_table</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_array</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_Fortran</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FortranModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.f90</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_table</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_array</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_table</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_array</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_Python</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PythonModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.py</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_table</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_array</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_table</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_array</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

  <span class="p p-Indicator">-</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_CPP</span>
    <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GCCModelDriver</span>
    <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.cpp</span>

    <span class="nt">inputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_file</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_table</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_array</span>

    <span class="nt">outputs</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_file</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileOutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_file.txt</span>
        <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_table</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_table.txt</span>
        <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_array</span>
        <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
        <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_array.txt</span>
        <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
        <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="c-version">
<h2><a class="toc-backref" href="#id4">C Version</a><a class="headerlink" href="#c-version" title="Permalink to this headline">¶</a></h2>
<p>Model Code:</p>
<div class="highlight-c notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="c1">// Include interface methods</span>
<span class="cp">#include</span> <span class="cpf">&quot;YggInterface.h&quot;</span><span class="cp"></span>

<span class="cp">#define BSIZE 8192 </span><span class="c1">// the max</span>



<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
  <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">error_code</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// Input &amp; output to an ASCII file line by line</span>
  <span class="n">yggAsciiFileInput_t</span> <span class="n">FileInput</span> <span class="o">=</span> <span class="n">yggAsciiFileInput</span><span class="p">(</span><span class="s">&quot;inputC_file&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiFileOutput_t</span> <span class="n">FileOutput</span> <span class="o">=</span> <span class="n">yggAsciiFileOutput</span><span class="p">(</span><span class="s">&quot;outputC_file&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table row by row</span>
  <span class="n">yggAsciiTableInput_t</span> <span class="n">TableInput</span> <span class="o">=</span> <span class="n">yggAsciiTableInput</span><span class="p">(</span><span class="s">&quot;inputC_table&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiTableOutput_t</span> <span class="n">TableOutput</span> <span class="o">=</span> <span class="n">yggAsciiTableOutput</span><span class="p">(</span><span class="s">&quot;outputC_table&quot;</span><span class="p">,</span>
							  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table as an array</span>
  <span class="n">yggAsciiArrayInput_t</span> <span class="n">ArrayInput</span> <span class="o">=</span> <span class="n">yggAsciiArrayInput</span><span class="p">(</span><span class="s">&quot;inputC_array&quot;</span><span class="p">);</span>
  <span class="n">yggAsciiArrayOutput_t</span> <span class="n">ArrayOutput</span> <span class="o">=</span> <span class="n">yggAsciiArrayOutput</span><span class="p">(</span><span class="s">&quot;outputC_array&quot;</span><span class="p">,</span>
							  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

  <span class="c1">// Read lines from ASCII text file until end of file is reached.</span>
  <span class="c1">// As each line is received, it is then sent to the output ASCII file.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): Receiving/sending ASCII file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">line_size</span> <span class="o">=</span> <span class="n">LINE_SIZE_MAX</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">line_size</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">line_size</span> <span class="o">=</span> <span class="n">LINE_SIZE_MAX</span><span class="p">;</span> <span class="c1">// Reset to size of buffer</span>

    <span class="c1">// Receive a single line</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecvRealloc</span><span class="p">(</span><span class="n">FileInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">line</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">line_size</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the line to output</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;File: %s&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">FileOutput</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">line_size</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING LINE</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of file input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

  <span class="c1">// Read rows from ASCII table until end of file is reached.</span>
  <span class="c1">// As each row is received, it is then sent to the output ASCII table</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): Receiving/sending ASCII table.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">BSIZE</span><span class="p">];</span>
  <span class="kt">size_t</span> <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">number</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">value</span><span class="p">;</span>
  <span class="n">complex_double</span> <span class="n">comp</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span> <span class="c1">// Reset to size of the buffer</span>

    <span class="c1">// Receive a single row with values stored in scalars declared locally</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecv</span><span class="p">(</span><span class="n">TableInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp</span><span class="p">);</span>
		      
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the values to output. Formatting</span>
      <span class="c1">// is taken care of on the output driver side.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Table: %.5s, %ld, %3.1f, %g%+gj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
  	     <span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">creal</span><span class="p">(</span><span class="n">comp</span><span class="p">),</span> <span class="n">cimag</span><span class="p">(</span><span class="n">comp</span><span class="p">));</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">TableOutput</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_siz</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">comp</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING ROW</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of table input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Read entire array from ASCII table into columns that are dynamically</span>
  <span class="c1">// allocated. The returned values tells us the number of elements in the</span>
  <span class="c1">// columns.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Receiving/sending ASCII table as array.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">nrows</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">name_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">long</span> <span class="o">*</span><span class="n">number_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">double</span> <span class="o">*</span><span class="n">value_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">complex_double</span> <span class="o">*</span><span class="n">comp_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">yggRecvRealloc</span><span class="p">(</span><span class="n">ArrayInput</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nrows</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp_arr</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Array: (%lu rows)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="p">);</span>
      <span class="c1">// Print each line in the array</span>
      <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.5s, %ld, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">[</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">number_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
	       <span class="n">value_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">creal</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">cimag</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
      <span class="c1">// Send the columns in the array to output. Formatting is handled on the</span>
      <span class="c1">// output driver side.</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">yggSend</span><span class="p">(</span><span class="n">ArrayOutput</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">name_arr</span><span class="p">,</span> <span class="n">number_arr</span><span class="p">,</span> <span class="n">value_arr</span><span class="p">,</span> <span class="n">comp_arr</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(C): ERROR SENDING ARRAY</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of array input (C)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
    
  <span class="c1">// Free dynamically allocated columns</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">name_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">number_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">number_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">value_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">value_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">comp_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">);</span>
  
  <span class="k">return</span> <span class="n">error_code</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">model</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_GCC</span>
  <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GCCModelDriver</span>
  <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.c</span>

  <span class="nt">inputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_file.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_table.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputC_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

  <span class="nt">outputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_file.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_table.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputC_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id5">C++ Version</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Model Code:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="c1">// Include interface methods</span>
<span class="cp">#include</span> <span class="cpf">&quot;YggInterface.hpp&quot;</span><span class="cp"></span>

<span class="cp">#define BSIZE 8192 </span><span class="c1">// the max</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
  <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">error_code</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// Input &amp; output to an ASCII file line by line</span>
  <span class="n">YggAsciiFileInput</span> <span class="n">FileInput</span><span class="p">(</span><span class="s">&quot;inputCPP_file&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiFileOutput</span> <span class="n">FileOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_file&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table row by row</span>
  <span class="n">YggAsciiTableInput</span> <span class="n">TableInput</span><span class="p">(</span><span class="s">&quot;inputCPP_table&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiTableOutput</span> <span class="n">TableOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_table&quot;</span><span class="p">,</span>
                                  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="c1">// Input &amp; output from a table as an array</span>
  <span class="n">YggAsciiArrayInput</span> <span class="n">ArrayInput</span><span class="p">(</span><span class="s">&quot;inputCPP_array&quot;</span><span class="p">);</span>
  <span class="n">YggAsciiArrayOutput</span> <span class="n">ArrayOutput</span><span class="p">(</span><span class="s">&quot;outputCPP_array&quot;</span><span class="p">,</span>
				  <span class="s">&quot;%5s</span><span class="se">\t</span><span class="s">%ld</span><span class="se">\t</span><span class="s">%3.1f</span><span class="se">\t</span><span class="s">%3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

  <span class="c1">// Read lines from ASCII text file until end of file is reached.</span>
  <span class="c1">// As each line is received, it is then sent to the output ASCII file.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): Receiving/sending ASCII file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">LINE_SIZE_MAX</span><span class="p">);</span>
  <span class="c1">// char line[LINE_SIZE_MAX];</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Receive a single line</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">FileInput</span><span class="p">.</span><span class="n">recv_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">LINE_SIZE_MAX</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the line to output</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;File: %s&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">);</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">FileOutput</span><span class="p">.</span><span class="n">send_line</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING LINE</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of file input (CPP)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="c1">// FileOutput.send_eof();</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">free</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>

  <span class="c1">// Read rows from ASCII table until end of file is reached.</span>
  <span class="c1">// As each row is received, it is then sent to the output ASCII table</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): Receiving/sending ASCII table.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
  <span class="kt">size_t</span> <span class="o">*</span> <span class="k">const</span> <span class="n">p_name_siz</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">;</span> <span class="c1">// Required in C++ to get name size</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">BSIZE</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">number</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">value</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">comp</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>  <span class="c1">// Reset to buffer size</span>

    <span class="c1">// Receive a single row with values stored in scalars declared locally</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">TableInput</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_siz</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp</span><span class="p">);</span>
    <span class="n">name_siz</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the receive was succesful, send the values to output. Formatting</span>
      <span class="c1">// is taken care of on the output driver side.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Table: %.5s, %d, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span>
  	     <span class="n">std</span><span class="o">::</span><span class="n">real</span><span class="p">(</span><span class="n">comp</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">imag</span><span class="p">(</span><span class="n">comp</span><span class="p">));</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">TableOutput</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">name_siz</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">comp</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING ROW</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">name_siz</span> <span class="o">=</span> <span class="n">BSIZE</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// If the receive was not succesful, send the end-of-file message to</span>
      <span class="c1">// close the output file.</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of table input (CPP)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Read entire array from ASCII table into columns that are dynamically</span>
  <span class="c1">// allocated. The returned values tells us the number of elements in the</span>
  <span class="c1">// columns.</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Receiving/sending ASCII table as array.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="kt">size_t</span> <span class="n">nrows</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">name_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">long</span> <span class="o">*</span><span class="n">number_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="kt">double</span> <span class="o">*</span><span class="n">value_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">comp_arr</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">ArrayInput</span><span class="p">.</span><span class="n">recvRealloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nrows</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">number_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value_arr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp_arr</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Array: (%lu rows)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="p">);</span>
      <span class="c1">// Print each line in the array</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrows</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.5s, %ld, %3.1f, %3.1lf%+3.1lfj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">name_arr</span><span class="p">[</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">],</span> <span class="n">number_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
  	       <span class="n">value_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std</span><span class="o">::</span><span class="n">real</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">std</span><span class="o">::</span><span class="n">imag</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
      <span class="c1">// Send the columns in the array to output. Formatting is handled on the</span>
      <span class="c1">// output driver side.</span>
      <span class="n">ret</span> <span class="o">=</span> <span class="n">ArrayOutput</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">name_arr</span><span class="p">,</span> <span class="n">number_arr</span><span class="p">,</span> <span class="n">value_arr</span><span class="p">,</span> <span class="n">comp_arr</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;ascii_io(CPP): ERROR SENDING ARRAY</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  	<span class="n">error_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  	<span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;End of array input (C++)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span> 
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">// Free dynamically allocated columns</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">name_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">name_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">number_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">number_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">value_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">value_arr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">comp_arr</span><span class="p">)</span> <span class="n">free</span><span class="p">(</span><span class="n">comp_arr</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">error_code</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">model</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_cpp</span>
  <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GCCModelDriver</span>
  <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.cpp</span>

  <span class="nt">inputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_file.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_table.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputCPP_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

  <span class="nt">outputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_file.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_table.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputCPP_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="fortran-version">
<h2><a class="toc-backref" href="#id6">Fortran Version</a><a class="headerlink" href="#fortran-version" title="Permalink to this headline">¶</a></h2>
<p>Model Code:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre></div></td><td class="code"><div class="highlight"><pre><span></span>program main
  ! Include interface methods
  use fygg

  integer, parameter :: BSIZE = 8192
  logical :: ret
  integer :: error_code = 0
  type(yggcomm) :: file_input, file_output, &amp;
       table_input, table_output, array_input, array_output
  integer(kind=c_size_t), target :: line_size = LINE_SIZE_MAX
  type(yggchar_r) :: line  ! Wrapped to be reallocatable
  character(len=BSIZE), target :: name
  integer(kind=c_size_t), target :: name_siz = BSIZE
  integer(kind=8) :: number
  real(kind=8) :: value
  complex(kind=8) :: comp
  integer(kind=c_size_t), target :: nrows
  type(character_1d), target :: name_arr
  type(integer8_1d), target :: number_arr
  type(real8_1d), target :: value_arr
  type(complex8_1d), target :: comp_arr
  integer(kind=c_size_t) :: i

  ! Input &amp; output to an ASCII file line by line
  file_input = ygg_ascii_file_input(&quot;inputF_file&quot;)
  file_output = ygg_ascii_file_output(&quot;outputF_file&quot;)
  ! Input &amp; output from a table row by row
  table_input = ygg_ascii_table_input(&quot;inputF_table&quot;)
  table_output = ygg_ascii_table_output(&quot;outputF_table&quot;, &amp;
       &quot;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&quot;)
  ! Input &amp; output from a table as an array
  array_input = ygg_ascii_array_input(&quot;inputF_array&quot;)
  array_output = ygg_ascii_array_output(&quot;outputF_array&quot;, &amp;
       &quot;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&quot;)

  ! Read lines from ASCII text file until end of file is reached.
  ! As each line is received, it is then sent to the output ASCII file.
  write(*, &#39;(&quot;ascii_io(F): Receiving/sending ASCII file.&quot;)&#39;)
  ret = .true.
  do while (ret)
     line_size = size(line%x)  ! Reset to size of buffer

     ! Receive a single line
     ret = ygg_recv_var_realloc(file_input, &amp;
          [yggarg(line), yggarg(line_size)])
     if (ret) then
        ! If the receive was succesful, send the line to output
        write(*, &#39;(&quot;File: &quot;,80A)&#39;, advance=&quot;no&quot;) line%x
        ret = ygg_send_var(file_output, &amp;
             [yggarg(line), yggarg(line_size)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING LINE&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        ! If the receive was not succesful, send the end-of-file message to
        ! close the output file.
        write(*, &#39;(&quot;End of file input (F)&quot;)&#39;)
     end if
  end do

  ! Read rows from ASCII table until end of file is reached.
  ! As each row is received, it is then sent to the output ASCII table
  write(*, &#39;(&quot;ascii_io(F): Receiving/sending ASCII table.&quot;)&#39;)
  ret = .true.
  do while (ret)
     name_siz = BSIZE  ! Reset to size of the buffer

     ! Receive a single row with values stored in scalars declared locally
     ret = ygg_recv_var(table_input, &amp;
          [yggarg(name), yggarg(name_siz), yggarg(number), &amp;
          yggarg(value), yggarg(comp)])

     if (ret) then
        ! If the receive was succesful, send the values to output. Formatting
        ! is taken care of on the output driver side.
        write (*, &#39;(&quot;Table: &quot;,A,&quot;, &quot;,I7,&quot;, &quot;,F10.5,&quot;, &quot;,2F10.5)&#39;) &amp;
             trim(name), number, value, comp
        ret = ygg_send_var(table_output, &amp;
             [yggarg(name), yggarg(name_siz), yggarg(number), &amp;
             yggarg(value), yggarg(comp)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING ROW&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        ! If the receive was not succesful, send the end-of-file message to
        ! close the output file.
        write(*, &#39;(&quot;End of table input (F)&quot;)&#39;)
     end if
  end do

  ! Read entire array from ASCII table into columns that are dynamically
  ! allocated. The returned values tells us the number of elements in the
  ! columns.
  write(*, &#39;(&quot;Receiving/sending ASCII table as array.&quot;)&#39;)
  ret = .true.
  do while (ret)
     ret = ygg_recv_var_realloc(array_input, [yggarg(nrows), &amp;
          yggarg(name_arr), yggarg(number_arr), &amp;
          yggarg(value_arr), yggarg(comp_arr)])
     if (ret) then
        write(*, &#39;(&quot;Array: (&quot;,I7,&quot; rows)&quot;)&#39;) nrows
        ! Print each line in the array
        do i = 1, nrows
           write(*, &#39;(5A)&#39;, advance=&quot;no&quot;) name_arr%x(i)%x
           write(*, &#39;(&quot;, &quot;,I7,&quot;, &quot;,F10.5,&quot;, &quot;,2F10.5)&#39;) &amp;
                number_arr%x(i), value_arr%x(i), comp_arr%x(i)
        end do
        ! Send the columns in the array to output. Formatting is handled on the
        ! output driver side.
        ret = ygg_send_var(array_output, [yggarg(nrows), &amp;
             yggarg(name_arr), yggarg(number_arr), &amp;
             yggarg(value_arr), yggarg(comp_arr)])
        if (.not.ret) then
           write(*, &#39;(&quot;ascii_io(F): ERROR SENDING ARRAY&quot;)&#39;)
           error_code = -1
           exit
        end if
     else
        write(*, &#39;(&quot;End of array input (F)&quot;)&#39;)
     end if
  end do

  if (error_code.lt.0) then
     stop 1
  end if

end program main
</pre></div>
</td></tr></table></div>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">model</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_Fortran</span>
  <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">FortranModelDriver</span>
  <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.f90</span>

  <span class="nt">inputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_file.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_table.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputF_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

  <span class="nt">outputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_file.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_table.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputF_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="matlab-version">
<h2><a class="toc-backref" href="#id7">Matlab Version</a><a class="headerlink" href="#matlab-version" title="Permalink to this headline">¶</a></h2>
<p>Model Code:</p>
<div class="highlight-matlab notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">% Input &amp; output to an ASCII file line by line </span>
<span class="n">in_file</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiFileInput&#39;</span><span class="p">,</span> <span class="s">&#39;inputM_file&#39;</span><span class="p">);</span>
<span class="n">out_file</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiFileOutput&#39;</span><span class="p">,</span> <span class="s">&#39;outputM_file&#39;</span><span class="p">);</span>
<span class="c">% Input &amp; output from a table row by row</span>
<span class="n">in_table</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiTableInput&#39;</span><span class="p">,</span> <span class="s">&#39;inputM_table&#39;</span><span class="p">);</span>
<span class="n">out_table</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiTableOutput&#39;</span><span class="p">,</span> <span class="s">&#39;outputM_table&#39;</span><span class="p">,</span> <span class="c">...</span>
			 <span class="s">&#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;</span><span class="p">);</span>
<span class="c">% Input &amp; output from a table as an array</span>
<span class="n">in_array</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiArrayInput&#39;</span><span class="p">,</span> <span class="s">&#39;inputM_array&#39;</span><span class="p">);</span>
<span class="n">out_array</span> <span class="p">=</span> <span class="n">YggInterface</span><span class="p">(</span><span class="s">&#39;YggAsciiArrayOutput&#39;</span><span class="p">,</span> <span class="s">&#39;outputM_array&#39;</span><span class="p">,</span> <span class="c">...</span>
			 <span class="s">&#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;</span><span class="p">);</span>

<span class="c">% Read lines from ASCII text file until end of file is reached.</span>
<span class="c">% As each line is received, it is then sent to the output ASCII file.</span>
<span class="nb">disp</span><span class="p">(</span><span class="s">&#39;ascii_io(M): Receiving/sending ASCII file.&#39;</span><span class="p">);</span>
<span class="n">flag</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span>
<span class="k">while</span> <span class="n">flag</span>
  <span class="c">% Receive a single line</span>
  <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">line</span><span class="p">]</span> <span class="p">=</span> <span class="n">in_file</span><span class="p">.</span><span class="n">recv</span><span class="p">();</span>
  <span class="k">if</span> <span class="n">flag</span>
    <span class="c">% If the receive was succesful, send the line to output</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;File: %s&#39;</span><span class="p">,</span> <span class="n">char</span><span class="p">(</span><span class="n">line</span><span class="p">));</span>
    <span class="n">ret</span> <span class="p">=</span> <span class="n">out_file</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">ret</span><span class="p">);</span>
      <span class="n">error</span><span class="p">(</span><span class="s">&#39;ascii_io(M): ERROR SENDING LINE&#39;</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">end</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="c">% If the receive was not succesful, send the end-of-file message to</span>
    <span class="c">% close the output file. </span>
    <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;End of file input (Matlab)&#39;</span><span class="p">);</span>
    <span class="n">out_file</span><span class="p">.</span><span class="n">send_eof</span><span class="p">();</span>
  <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="c">% Read rows from ASCII table until end of file is reached.</span>
<span class="c">% As each row is received, it is then sent to the output ASCII table</span>
<span class="n">flag</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span>
<span class="k">while</span> <span class="n">flag</span>
  <span class="c">% Receive a single row</span>
  <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">line</span><span class="p">]</span> <span class="p">=</span> <span class="n">in_table</span><span class="p">.</span><span class="n">recv</span><span class="p">();</span>
  <span class="k">if</span> <span class="n">flag</span>
    <span class="c">% If the receive was succesful, send the values to output.</span>
    <span class="c">% Formatting is taken care of on the output driver side.</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Table: %s, %d, %3.1f, %3.1f%+3.1fi\n&#39;</span><span class="p">,</span> <span class="n">char</span><span class="p">(</span><span class="n">line</span><span class="p">{</span><span class="mi">1</span><span class="p">}),</span> <span class="c">...</span>
	    <span class="n">line</span><span class="p">{</span><span class="mi">2</span><span class="p">},</span> <span class="n">line</span><span class="p">{</span><span class="mi">3</span><span class="p">},</span> <span class="nb">real</span><span class="p">(</span><span class="n">line</span><span class="p">{</span><span class="mi">4</span><span class="p">}),</span> <span class="nb">imag</span><span class="p">(</span><span class="n">line</span><span class="p">{</span><span class="mi">4</span><span class="p">}));</span>
    <span class="n">ret</span> <span class="p">=</span> <span class="n">out_table</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">ret</span><span class="p">);</span>
      <span class="n">error</span><span class="p">(</span><span class="s">&#39;ascii_io(M): ERROR SENDING ROW&#39;</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">end</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="c">% If the receive was not succesful, send the end-of-file message to</span>
    <span class="c">% close the output file.</span>
    <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;End of table input (Matlab)&#39;</span><span class="p">);</span>
    <span class="n">out_table</span><span class="p">.</span><span class="n">send_eof</span><span class="p">();</span>
  <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="c">% Read entire array from ASCII table into an array</span>
<span class="n">flag</span> <span class="p">=</span> <span class="n">true</span><span class="p">;</span>
<span class="k">while</span> <span class="n">flag</span>
  <span class="p">[</span><span class="n">flag</span><span class="p">,</span> <span class="n">arr</span><span class="p">]</span> <span class="p">=</span> <span class="n">in_array</span><span class="p">.</span><span class="n">recv_array</span><span class="p">();</span>
  <span class="k">if</span> <span class="n">flag</span>
    <span class="n">nr</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Array: (%d rows)\n&#39;</span><span class="p">,</span> <span class="n">nr</span><span class="p">);</span>
    <span class="c">% Print each line in the array</span>
    <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">nr</span>
      <span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;%5s, %d, %3.1f, %3.1f%+3.1fi\n&#39;</span><span class="p">,</span> <span class="c">...</span>
              <span class="n">char</span><span class="p">(</span><span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">1</span><span class="p">}),</span> <span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span> <span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span> <span class="c">...</span>
              <span class="nb">real</span><span class="p">(</span><span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">4</span><span class="p">}),</span> <span class="nb">imag</span><span class="p">(</span><span class="n">arr</span><span class="p">{</span><span class="nb">i</span><span class="p">,</span><span class="mi">4</span><span class="p">}));</span>
    <span class="k">end</span><span class="p">;</span>
    <span class="c">% Send the array to output. Formatting is handled on the output driver side.</span>
    <span class="n">ret</span> <span class="p">=</span> <span class="n">out_array</span><span class="p">.</span><span class="n">send_array</span><span class="p">(</span><span class="n">arr</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">ret</span><span class="p">);</span>
      <span class="n">error</span><span class="p">(</span><span class="s">&#39;ascii_io(M): ERROR SENDING ARRAY&#39;</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">end</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="c">% If the receive was not succesful, send the end-of-file message to</span>
    <span class="c">% close the output file.</span>
    <span class="nb">disp</span><span class="p">(</span><span class="s">&#39;End of array input (Matlab)&#39;</span><span class="p">);</span>
  <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">model</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_Matlab</span>
  <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MatlabModelDriver</span>
  <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.m</span>

  <span class="nt">inputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputM_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_file.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputM_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_table.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputM_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

  <span class="nt">outputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputM_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_file.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputM_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_table.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputM_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="python-version">
<h2><a class="toc-backref" href="#id8">Python Version</a><a class="headerlink" href="#python-version" title="Permalink to this headline">¶</a></h2>
<p>Model Code:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="c1"># Import necessary connection interfaces</span>
<span class="kn">from</span> <span class="nn">yggdrasil.tools</span> <span class="kn">import</span> <span class="n">print_encoded</span>
<span class="kn">from</span> <span class="nn">yggdrasil.interface.YggInterface</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">YggAsciiFileInput</span><span class="p">,</span> <span class="n">YggAsciiFileOutput</span><span class="p">,</span>
    <span class="n">YggAsciiTableInput</span><span class="p">,</span> <span class="n">YggAsciiTableOutput</span><span class="p">,</span>
    <span class="n">YggAsciiArrayInput</span><span class="p">,</span> <span class="n">YggAsciiArrayOutput</span><span class="p">)</span>

    
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="c1"># Input &amp; output to an ASCII file line by line</span>
    <span class="n">in_file</span> <span class="o">=</span> <span class="n">YggAsciiFileInput</span><span class="p">(</span><span class="s1">&#39;inputPy_file&#39;</span><span class="p">)</span>
    <span class="n">out_file</span> <span class="o">=</span> <span class="n">YggAsciiFileOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_file&#39;</span><span class="p">)</span>
    <span class="c1"># Input &amp; output from a table row by row</span>
    <span class="n">in_table</span> <span class="o">=</span> <span class="n">YggAsciiTableInput</span><span class="p">(</span><span class="s1">&#39;inputPy_table&#39;</span><span class="p">)</span>
    <span class="n">out_table</span> <span class="o">=</span> <span class="n">YggAsciiTableOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_table&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;</span><span class="si">%5s</span><span class="se">\t</span><span class="si">%ld</span><span class="se">\t</span><span class="si">%3.1f</span><span class="se">\t</span><span class="si">%3.1lf%+3.1lf</span><span class="s1">j</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># Input &amp; output from a table as an array</span>
    <span class="n">in_array</span> <span class="o">=</span> <span class="n">YggAsciiArrayInput</span><span class="p">(</span><span class="s1">&#39;inputPy_array&#39;</span><span class="p">)</span>
    <span class="n">out_array</span> <span class="o">=</span> <span class="n">YggAsciiArrayOutput</span><span class="p">(</span><span class="s1">&#39;outputPy_array&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;</span><span class="si">%5s</span><span class="se">\t</span><span class="si">%ld</span><span class="se">\t</span><span class="si">%3.1f</span><span class="se">\t</span><span class="si">%3.1lf%+3.1lf</span><span class="s1">j</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Read lines from ASCII text file until end of file is reached.</span>
    <span class="c1"># As each line is received, it is then sent to the output ASCII file.</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ascii_io(P): Receiving/sending ASCII file.&#39;</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="c1"># Receive a single line</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="c1"># If the receive was succesful, send the line to output</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;File: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_file</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING LINE&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the receive was not succesful, send the end-of-file message to</span>
            <span class="c1"># close the output file.</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;End of file input (Python)&quot;</span><span class="p">)</span>
            <span class="n">out_file</span><span class="o">.</span><span class="n">send_eof</span><span class="p">()</span>

    <span class="c1"># Read rows from ASCII table until end of file is reached.</span>
    <span class="c1"># As each row is received, it is then sent to the output ASCII table</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ascii_io(P): Receiving/sending ASCII table.&#39;</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="c1"># Receive a single row</span>
        <span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="o">=</span> <span class="n">in_table</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="c1"># If the receive was succesful, send the values to output.</span>
            <span class="c1"># Formatting is taken care of on the output driver side.</span>
            <span class="n">print_encoded</span><span class="p">(</span><span class="s2">&quot;Table: </span><span class="si">%s</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%3.1f</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
            <span class="c1"># print(&quot;Table: %s, %d, %3.1f, %s&quot; % line)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_table</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING ROW&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the receive was not succesful, send the end-of-file message to</span>
            <span class="c1"># close the output file.</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;End of table input (Python)&quot;</span><span class="p">)</span>
            <span class="n">out_table</span><span class="o">.</span><span class="n">send_eof</span><span class="p">()</span>

    <span class="c1"># Read entire array from ASCII table into numpy array</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">ret</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">,</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">in_array</span><span class="o">.</span><span class="n">recv_array</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Array: (</span><span class="si">%d</span><span class="s2"> rows)&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
            <span class="c1"># Print each line in the array</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)):</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%5s</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%3.1f</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="c1"># Send the array to output. Formatting is handled on the output driver side.</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">out_array</span><span class="o">.</span><span class="n">send_array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): ERROR SENDING ARRAY&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;ascii_io(P): End of array input (Python)&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">model</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_Python</span>
  <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PythonModelDriver</span>
  <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.py</span>

  <span class="nt">inputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_file.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_table.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputPy_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

  <span class="nt">outputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_file.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_table.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputPy_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="r-version">
<h2><a class="toc-backref" href="#id9">R Version</a><a class="headerlink" href="#r-version" title="Permalink to this headline">¶</a></h2>
<p>Model Code:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79</pre></div></td><td class="code"><div class="highlight"><pre><span></span>library(yggdrasil)

# Input &amp; output to an ASCII file line by line
in_file &lt;- YggInterface(&#39;YggAsciiFileInput&#39;, &#39;inputR_file&#39;)
out_file &lt;- YggInterface(&#39;YggAsciiFileOutput&#39;, &#39;outputR_file&#39;)
# Input &amp; output from a table row by row
in_table &lt;- YggInterface(&#39;YggAsciiTableInput&#39;, &#39;inputR_table&#39;)
out_table &lt;- YggInterface(&#39;YggAsciiTableOutput&#39;, &#39;outputR_table&#39;,
                          &#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;)
# Input &amp; output from a table as an array
in_array &lt;- YggInterface(&#39;YggAsciiArrayInput&#39;, &#39;inputR_array&#39;)
out_array &lt;- YggInterface(&#39;YggAsciiArrayOutput&#39;, &#39;outputR_array&#39;,
                          &#39;%5s\t%ld\t%3.1f\t%3.1lf%+3.1lfj\n&#39;)

# Read lines from ASCII text file until end of file is reached.
# As each line is received, it is then sent to the output ASCII file.
print(&#39;ascii_io(R): Receiving/sending ASCII file.&#39;)
ret = TRUE
while (ret) {
  # Receive a single line
  c(ret, line) %&lt;-% in_file$recv()
  if (ret) {
    # If the receive was succesful, send the line to output
    fprintf(&#39;File: %s&#39;, line)
    ret &lt;- out_file$send(line)
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING LINE&quot;)
    }
  } else {
    # If the receive was not succesful, send the end-of-file message to
    # close the output file.
    print(&quot;End of file input (R)&quot;)
    out_file$send_eof()
  }
}

# Read rows from ASCII table until end of file is reached.
# As each row is received, it is then sent to the output ASCII table
print(&#39;ascii_io(R): Receiving/sending ASCII table.&#39;)
ret &lt;- TRUE
while (ret) {
  # Receive a single row
  c(ret, line) %&lt;-% in_table$recv()
  if (ret) {
    # If the receive was succesful, send the values to output.
    # Formatting is taken care of on the output driver side.
    fprintf(&quot;Table: %s, %d, %3.1f, %s&quot;, line[[1]], line[[2]], line[[3]], line[[4]])
    ret &lt;- out_table$send(line[[1]], line[[2]], line[[3]], line[[4]])
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING ROW&quot;)
    }
  } else {
    # If the receive was not succesful, send the end-of-file message to
    # close the output file.
    print(&quot;End of table input (R)&quot;)
    out_table$send_eof()
  }
}

# Read entire array from ASCII table into numpy array
ret &lt;- TRUE
while (ret) {
  c(ret, arr) %&lt;-% in_array$recv_array()
  if (ret) {
    fprintf(&quot;Array: (%d rows)&quot;, length(arr))
    # Print each line in the array
    for (i in 1:length(arr)) {
      fprintf(&quot;%5s, %d, %3.1f, %s&quot;,
              arr[[i]][[1]], arr[[i]][[2]], arr[[i]][[3]], arr[[i]][[4]])
    }
    # Send the array to output. Formatting is handled on the output driver side.
    ret &lt;- out_array$send_array(arr)
    if (!ret) {
      stop(&quot;ascii_io(R): ERROR SENDING ARRAY&quot;)
    }
  } else {
    print(&quot;ascii_io(R): End of array input (R)&quot;)
  }
}
</pre></div>
</td></tr></table></div>
<p>Model YAML:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="nt">model</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ascii_io_R</span>
  <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RModelDriver</span>
  <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">src/ascii_io.R</span>

  <span class="nt">inputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputR_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_file.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputR_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_table.txt</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">inputR_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableInputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./Input/input_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

  <span class="nt">outputs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputR_file</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiFileOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_file.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputR_table</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_table.txt</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">outputR_array</span>
      <span class="nt">driver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AsciiTableOutputDriver</span>
      <span class="nt">args</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">output_array.txt</span>
      <span class="nt">as_array</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">in_temp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
      <span class="nt">field_names</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">name,number,value,complex</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017, Meagan Lang, David Raila.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>